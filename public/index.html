<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ä¸‰å°éš»æ—¥å¸¸ç™¾è²¨ï½œç™‚ç™’ç”Ÿæ´»ç™¾è²¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!--
    =========================
    ç‰ˆå‹èªªæ˜
    =========================
    - å–®æª”éœæ…‹é ï¼ˆHTML + CSS + JSï¼‰
    - å•†å“è³‡æ–™ï¼šç”±å¾Œç«¯ GET /api/products æä¾›
    - å»ºç«‹è¨‚å–®ï¼šPOST /api/orders
    - åœ–ç‰‡ï¼šSupabase Storage Public Bucket
    - åŠŸèƒ½ï¼šåˆ†é¡ã€æœå°‹ã€å•†å“è©³æƒ…ã€åŠ å…¥è³¼ç‰©è»Šã€çµå¸³ã€è¨‚å–®æŸ¥è©¢ï¼ˆå‰ç«¯æ¨¡æ¿ï¼‰
  -->

  <style>
/* =========================================================
  0) Reset / Base
========================================================= */
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Microsoft JhengHei",sans-serif;
  line-height:1.6;
  color:#3f3a4f;
  background:linear-gradient(180deg,#ffffff 0%,#fff6d3 30%,#e6f2ff 90%);
}
a{text-decoration:none;color:inherit}

/* =========================================================
  1) Header / Nav
========================================================= */
header{
  position:sticky;top:0;z-index:10;
  background:rgba(255,255,255,.92);
  border-bottom:1px solid rgba(188,220,255,.8);
  backdrop-filter:blur(8px);
}
.nav{
  max-width:1100px;margin:8px auto;
  padding:10px 18px;
  display:flex;align-items:center;justify-content:space-between;
  border-radius:999px;
  background:linear-gradient(90deg,rgba(255,229,166,.65),rgba(232,243,255,.9));
}
.logo{display:flex;gap:8px;font-weight:700}
.logo-badge{
  width:30px;height:30px;border-radius:50%;
  background:radial-gradient(circle,#fff,#ffe9a7 45%,#ffd26b);
  display:flex;align-items:center;justify-content:center;
}
.nav-links{
  display:flex; gap:14px; align-items:center;
  font-size:13px;
}
.nav-links a{
  padding:6px 10px;
  border-radius:999px;
  background:rgba(255,255,255,.55);
  border:1px solid rgba(188,220,255,.7);
}
.nav-action{display:flex; align-items:center; gap:10px;}

/* =========================================================
  2) Buttons
========================================================= */
.btn-primary{
  padding:6px 14px;border-radius:999px;
  background:linear-gradient(135deg,#ffe38a,#f5b944);
  border:none;cursor:pointer;
  box-shadow:0 4px 12px rgba(240,188,62,.45);
}
.btn-secondary{
  padding:6px 12px;border-radius:999px;
  border:1px solid #bcdcff;
  background:#e8f3ff;
}

/* =========================================================
  3) Layout
========================================================= */
main{max-width:1100px;margin:0 auto;padding:16px}

/* =========================================================
  4) Hero
========================================================= */
.hero{
  margin-top:10px;
  background:linear-gradient(180deg,#fffdf3, #ffffff);
  border:1px solid rgba(188,220,255,.7);
  border-radius:22px;
  padding:16px;
  box-shadow:0 10px 28px rgba(118,165,228,.18);
  position:relative;
  isolation:isolate; /* âœ… é¿å…è¼ªæ’­åœ–å±¤è·‘åˆ°ä¸‹é¢å€å¡Š */
  z-index:1;
  min-height: 520px;   /* â† ä½ å¯ä»¥è©¦ 500 / 540 / 580 */
  padding: 24px;       /* è®“è£¡é¢æ›´èˆ’æœ */
}
.hero-top{
  display:flex; align-items:center; justify-content:space-between;
  gap:12px; flex-wrap:wrap;
}
.hero-search{
  display:flex; align-items:center; gap:8px;
  padding:8px 12px;
  border-radius:999px;
  background:#fff;
  border:1px solid rgba(188,220,255,.9);
  box-shadow:0 6px 16px rgba(118,165,228,.12);
  min-width:280px;
}
.hero-search input{
  border:none; outline:none; width:100%;
  font-size:13px; background:transparent;
}
.hero-main{
  margin-top:14px;
  display:grid;
  grid-template-columns:1.2fr .9fr;
  gap:18px;
  align-items:start; /* âœ… å³å´è¼ªæ’­è²¼é½Šä¸Šæ–¹ */
}
@media(max-width:900px){
  .hero-main{grid-template-columns:1fr;}
}

.hero-left-title{font-size:22px;font-weight:800; letter-spacing:.2px;}
.hero-left-sub{margin-top:6px; font-size:13px; color:#6c6480;}
.hero-benefits-row{margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;}
.hero-benefit{
  font-size:13px;
  padding:6px 10px;
  border-radius:999px;
  background:#fff6d3;
  border:1px dashed #f0d9a4;
  color:#7a5c3a;
}
.hero-actions-row{margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;}
.hero-primary-btn{
  padding:10px 14px;border-radius:999px;border:none;cursor:pointer;
  background:linear-gradient(135deg,#ffe38a,#f5b944);
  box-shadow:0 6px 16px rgba(240,188,62,.35);
  font-weight:700;
}
.hero-secondary-btn{
  padding:10px 14px;border-radius:999px;cursor:pointer;
  background:#e8f3ff; border:1px solid #bcdcff;
}
.hero-left-note{margin-top:10px; font-size:13.5px; color:#5c452b; line-height:1.75;}

/* =========================================================
  5) Hero Banner (Right side carousel) - âœ… æœ€çµ‚ä¹¾æ·¨ç‰ˆ
========================================================= */
.hero-banner-badge{ display:none !important; } /* ä½ èªªä¸è¦é¡¯ç¤º 9æŠ˜/95æŠ˜ */

.hero-banner{
  position:relative;
  border-radius:22px;
  overflow:hidden; /* âœ… ä¸è®“ slide è·‘å‡ºå» */
  border:1px solid rgba(188,220,255,.75);
  background:linear-gradient(180deg,#ffffff,#fffdf3);
  box-shadow:0 10px 28px rgba(118,165,228,.18);
  height:420px;
  display:flex;
  flex-direction:column;
  align-self:start;
}
.hero-banner-slides{
  position:relative;
  flex:1;
  min-height:0;
}
.hero-banner-slide{
  position:absolute;
  inset:0;
  opacity:0;
  pointer-events:none;
  transform:translateY(6px);
  transition:opacity .35s ease, transform .35s ease;
  padding:14px;
  display:flex;
  flex-direction:column;
  gap:12px;
}
.hero-banner-slide.active{
  opacity:1;
  pointer-events:auto;
  transform:translateY(0);
}
.hero-banner-top{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
}
.hero-banner-tag{
  display:inline-flex;
  font-size:13px;
  padding:6px 10px;
  border-radius:999px;
  background:#fff6d3;
  border:1px dashed #f0d9a4;
  color:#7a5c3a;
  font-weight:800;
}
.hero-banner-title{
  margin-top:8px;
  font-size:16px;
  font-weight:900;
  color:#3f3a4f;
}
.hero-banner-sub{
  margin-top:6px;
  font-size:13px;
  color:#6c6480;
  line-height:1.7;
}




/* âœ… Hero è¼ªæ’­ä¸»åœ–ï¼šå¡«æ»¿ã€ä¸ç•™ç™½ï¼ˆé›»å•† Banner æ¨™æº–ï¼‰ */
.hero-banner-media img{
  width:100%;
  height:100%;
  object-fit:cover;   /* â† é—œéµåªæœ‰é€™è¡Œ */
  display:block;
  background:#fff;
}

  margin-top:auto;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.hero-banner-cta button{
  padding:9px 12px;
  border-radius:999px;
  border:none;
  cursor:pointer;
  font-weight:900;
}
.hero-banner-cta .cta-primary{
  background:linear-gradient(135deg,#ffe38a,#f5b944);
  box-shadow:0 6px 16px rgba(240,188,62,.25);
}
.hero-banner-cta .cta-secondary{
  background:#e8f3ff;
  border:1px solid #bcdcff;
}
.hero-banner-dots-row{
  flex:0 0 auto;
  padding:0 14px 14px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
}
.hero-banner-hint{font-size:11px;color:#9a7641;}
.hero-dots{display:flex;gap:8px}
.hero-dot{
  width:10px;height:10px;
  border-radius:999px;
  border:1px solid rgba(188,220,255,.9);
  background:#ffffff;
  cursor:pointer;
  padding:0;
}
.hero-dot.active{
  background:#f5b944;
  border-color:#f0d9a4;
  box-shadow:0 0 0 3px rgba(255,210,96,.25);
}
@media(max-width:900px){ .hero-banner{height:300px;} }
@media(max-width:520px){
  .hero-banner-media{aspect-ratio:4/3;}
  .hero-banner-cta button{width:100%;}
}



/* âœ… å¼·åˆ¶ Hero è¼ªæ’­ä¸»åœ– 1:1ï¼ˆæ”¾åœ¨ CSS æœ€åº•ä¸‹ï¼‰ */
.hero-banner-media{
  aspect-ratio: 1 / 1 !important;
   max-height: 230px;       /* â­ é—œéµï¼šé™åˆ¶åœ–ç‰‡å€é«˜åº¦ */
    margin: 0 auto;          /* ç½®ä¸­ï¼Œçœ‹èµ·ä¾†æ›´ç²¾ç·» */
}
.hero-banner-media img{
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;  /* ä¸ç•™ç™½ï¼Œå¡«æ»¿ */
  object-position: center !important;
}



/* =========================================================
  6) Section / Category
========================================================= */
.section-title{
  margin-top:22px;
  font-size:16px; font-weight:800;
  display:flex; flex-direction:column; gap:4px;
}
.section-title span{
  font-size:13px; font-weight:500; color:#7a5c3a;
}
.category-row{
  margin-top:10px;
  display:flex; flex-wrap:wrap; gap:8px;
}
.category-chip{
  cursor:pointer;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid rgba(188,220,255,.9);
  background:#fff;
  font-size:13px;
}
.category-chip.active{
  background:#fff6d3;
  border-color:#f0d9a4;
  box-shadow:0 4px 12px rgba(240,188,62,.18);
}

/* =========================================================
  7) Product Grid
========================================================= */
.product-grid{
  margin-top:14px;
  display:grid;
  grid-template-columns:repeat(5,1fr);
  gap:14px;
}
@media(max-width:768px){
  .product-grid{grid-template-columns:repeat(2,1fr)}
}
.product-card{
  position:relative;
  background:#fff;
  border:1px solid rgba(188,220,255,.8);
  border-radius:14px;
  padding:8px;
  box-shadow:0 10px 28px rgba(118,165,228,.25);
  transition:.15s;
}
.product-card:hover{transform:translateY(-3px)}

.product-tag{
  position:absolute; top:10px; left:10px;
  padding:4px 8px; border-radius:999px;
  font-size:11px; color:#7a5c3a;
  background:#fff6d3;
  border:1px dashed #f0d9a4;
}

/* âœ… å•†å“åœ–ç‰‡ä¿è­· */
.product-img{
  position:relative;
  padding-top:100%;
  background:#fff !important;
  border-radius:14px;
  overflow:hidden;
  border:1px solid rgba(0,0,0,.06);
}
.product-img img{
  position:absolute;inset:0;
  width:100%;height:100%;
  object-fit:cover;
  filter:none !important;
  background:#fff !important;
}

.product-name{margin-top:8px;font-size:13px;font-weight:800;}
.product-bottom{margin-top:8px; display:flex; flex-direction:column; gap:8px;}
.product-price-row{display:flex; align-items:center; justify-content:space-between;}
.product-price{font-weight:800;}
.product-like-btn{
  width:34px;height:34px;border-radius:999px;
  border:1px solid rgba(188,220,255,.9);
  background:#fff;
  cursor:pointer;
}
.product-like-btn.active{border-color:#ffb3c7;}

.card-spec-row{display:flex; gap:6px; flex-wrap:wrap;}
.card-spec-btn{
  padding:6px 10px; border-radius:999px;
  border:1px solid rgba(188,220,255,.9);
  background:#fff; cursor:pointer; font-size:13px;
}
.card-spec-btn.active{
  background:#e8f3ff;
  border-color:#9fd0ff;
}
.card-action-row{display:flex; align-items:center; justify-content:space-between; gap:10px;}
.qty-control{display:flex; align-items:center; gap:6px;}
.qty-btn{
  width:30px; height:30px; border-radius:10px;
  border:1px solid rgba(188,220,255,.9);
  background:#fff; cursor:pointer;
}
.qty-input{
  width:44px; height:30px; text-align:center;
  border-radius:10px;
  border:1px solid rgba(188,220,255,.9);
  outline:none;
}
.btn-cart{
  padding:8px 12px; border-radius:12px; cursor:pointer;
  border:none;
  background:linear-gradient(135deg,#ffe38a,#f5b944);
  box-shadow:0 6px 16px rgba(240,188,62,.25);
  font-weight:800;
}

/* =========================================================
  8) Product Detail
========================================================= */
.product-detail{display:none;}
.pd-layout{
  display:grid;
  grid-template-columns:1.4fr 1.1fr;
  gap:20px;
}
@media(max-width:768px){
  .pd-layout{grid-template-columns:1fr}
}
.pd-images{
  background:#fff !important;
  border:1px solid rgba(0,0,0,.08);
  border-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}
.pd-main-img{background:#fff !important;padding:10px;}
.pd-main-img img{
  max-width:100%;
  max-height:520px;
  object-fit:contain;
  filter:none !important;
}
.pd-thumb-btn{
  width:90px;height:90px;
  border-radius:10px;
  background:#fff !important;
  border:2px solid rgba(0,0,0,.08);
  overflow:hidden;
}
.pd-thumb-btn img{width:100%;height:100%;object-fit:cover;}
.pd-thumb-btn.active{
  border-color:#ffd260;
  box-shadow:0 0 0 3px rgba(255,210,96,.35);
}
.pd-info-title{font-size:18px;font-weight:900;}
.pd-info-sub{margin-top:4px;font-size:13px;color:#6c6480;}
.pd-price{margin-top:10px;font-size:16px;font-weight:900;}
.pd-price span{font-size:18px;}
.pd-spec-title{margin-top:12px;font-size:13px;font-weight:800;}
.pd-spec-options{margin-top:8px; display:flex; gap:8px; flex-wrap:wrap;}
.pd-spec-btn{
  padding:8px 12px; border-radius:999px;
  border:1px solid rgba(188,220,255,.9);
  background:#fff; cursor:pointer; font-size:13px;
}
.pd-spec-btn.active{
  background:#fff6d3;
  border-color:#f0d9a4;
}
.pd-thumbs{
  display:flex; gap:10px; flex-wrap:wrap;
  padding:10px;
  border-top:1px solid rgba(0,0,0,.06);
}
.pd-desc-detail{margin-top:12px;font-size:13px;color:#4f3b2a; line-height:1.75;}

/* =========================================================
  9) Cards / Sections
========================================================= */
.card{
  margin-top:26px;
  background:#fff;
  border-radius:22px;
  padding:16px;
  box-shadow:0 10px 28px rgba(118,165,228,.2);
}

/* =========================================================
  10) Forms
========================================================= */
.form-row{
  margin-top:10px;
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:12px;
}
@media(max-width:768px){
  .form-row{grid-template-columns:1fr;}
}
label{display:block; font-size:13px; font-weight:800; margin:10px 0 6px;}
input, select, textarea{
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(188,220,255,.9);
  outline:none;
  background:#fff;
  font-size:13px;
}
textarea{min-height:90px; resize:vertical;}

.field-error{margin-top:6px;font-size:13px;color:#c0392b;display:none}
.field-ok{margin-top:6px;font-size:13px;color:#2f6b3f;display:none}
.form-hint{margin-top:6px;font-size:13px;color:#9a7641;}
.form-note{margin-top:10px;font-size:13px;color:#7a5c3a;}
.form-actions{margin-top:12px; display:flex; gap:10px; flex-wrap:wrap; align-items:center;}

/* =========================================================
  11) Lightbox
========================================================= */
.lb{
  position:fixed; inset:0;
  display:none;
  align-items:center; justify-content:center;
  background:rgba(0,0,0,.65);
  z-index:9999;
  padding:18px;
}
.lb.open{display:flex;}
.lb-stage{
  max-width:min(1000px, 92vw);
  max-height:82vh;
  background:#111;
  border-radius:18px;
  padding:10px;
  display:flex; align-items:center; justify-content:center;
}
.lb-stage img{
  max-width:100%;
  max-height:78vh;
  object-fit:contain;
  border-radius:12px;
  background:#fff;
}
.lb-close{
  position:absolute; top:14px; right:14px;
  width:40px; height:40px;
  border-radius:999px;
  border:none; cursor:pointer;
  background:#fff;
  font-size:18px;
}
.lb-nav{
  position:absolute;
  top:50%; transform:translateY(-50%);
  width:44px; height:44px;
  border-radius:999px;
  border:none; cursor:pointer;
  background:#fff;
  font-size:26px;
  line-height:44px;
}
.lb-prev{left:14px;}
.lb-next{right:14px;}
.lb-hint{
  position:absolute; bottom:14px; left:50%;
  transform:translateX(-50%);
  font-size:13px;
  color:#fff;
  opacity:.9;
  text-align:center;
  padding:6px 10px;
  border-radius:999px;
  background:rgba(0,0,0,.35);
}

/* =========================================================
  12) Footer
========================================================= */
footer{
  margin-top:30px;
  padding:16px;
  font-size:11px;
  text-align:center;
  color:#9aa2bf;
}

/* =========================================================
  13) å³ä¸‹è§’è£é£¾ï¼ˆä½ æœ‰ HTML ä½†æ²’ CSSï¼Œä¸å¯«ä¹Ÿä¸å½±éŸ¿åŠŸèƒ½ï¼‰
========================================================= */
.sxz-cloud-buddies{position:fixed;right:10px;bottom:10px;pointer-events:none;opacity:.25}
  
/* =========================================================
  å®˜ç¶²ä»˜æ¬¾æ–¹å¼å…¬å‘Šï¼ˆå¯æ„›æç¤ºï¼‰
========================================================= */
.notice-cod{
  margin-top:14px;
  padding:14px 16px;
  border-radius:18px;
  background:linear-gradient(180deg,#fff7dc,#fff1c6);
  border:1px dashed #f0d9a4;
  display:flex;
  gap:12px;
  align-items:flex-start;
  box-shadow:0 6px 16px rgba(240,188,62,.18);
}

.notice-icon{
  font-size:28px;
  line-height:1;
  filter:drop-shadow(0 2px 0 rgba(255,255,255,.9));
}

.notice-content{flex:1;}

.notice-title{
  font-size:15px;
  font-weight:900;
  color:#7a5c3a;
  margin-bottom:4px;
}

.notice-text{
  font-size:14px;              /* å­—é«”æ”¾å¤§ */
  line-height:1.7;
  color:#5c452b;
}

.notice-text strong{color:#d35400;}

.notice-shopee-btn{
  margin-top:10px;
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:8px 14px;
  border-radius:999px;
  background:#ffefe6;
  border:1px solid #ffb08a;
  color:#b8481e;
  font-size:13px;
  font-weight:900;
  text-decoration:none;
  transition:transform .15s, box-shadow .15s;
  animation: sxz-bounce 2.2s ease-in-out infinite;
}

.notice-shopee-btn:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 14px rgba(255,120,60,.25);
  animation-play-state:paused; /* hover æ™‚åœä¸€ä¸‹ï¼Œé¿å…æ™ƒçœ¼ */
}

@keyframes sxz-bounce{
  0%, 60%, 100% { transform:translateY(0); }
  70% { transform:translateY(-3px); }
  80% { transform:translateY(0); }
  90% { transform:translateY(-2px); }
}


/* Hero feature pills bigger */
.hero-feat, .hero-feature, .hero-pill, .hero-chip, .hero-badge{
  font-size:14px;
}

.hero-features .chip,
.hero-features .feat,
.hero-features span{
  font-size: 14px;
}


/* =========================================================
  æœå°‹æ¢ï¼ˆç§»åˆ°å•†å“åˆ†é¡ä¸Šæ–¹ï¼‰
========================================================= */
.search-strip{
  max-width:1100px;
  margin:14px auto 6px;
  padding:0 16px;
}

/* =========================================================
  Mobileï¼šè¼ªæ’­å¡ç‰‡æ›´é«˜ã€æ›´å¥½çœ‹
========================================================= */
@media (max-width:520px){
  .search-strip{ margin:10px auto 4px; }
  .hero-banner{ height: 560px; }           /* åŸæœ¬ 420ï¼Œæ‰‹æ©ŸåŠ é«˜ */
  .hero-banner-media{ max-height: 320px; } /* åŸæœ¬ç´„ 230ï¼Œæ‰‹æ©ŸåŠ é«˜ */
}

</style>
</head>

<body>
  <!-- =========================================================
    Header / Navbar
  ========================================================= -->
  <header>
    <div class="nav">
      <div class="logo">
        <div class="logo-badge">â˜€</div>
        ä¸‰å°éš»æ—¥å¸¸å°ç‰©ç™¾è²¨
      </div>

      <nav class="nav-links" aria-label="ä¸»å°è¦½">
        <a href="#products">å•†å“</a>
        <a href="#checkout">çµå¸³</a>
        <a href="#order-query">è¨‚å–®æŸ¥è©¢</a>
        <a href="#about">å“ç‰Œæ•…äº‹</a>
      </nav>

      <div class="nav-action">
        <button class="btn-primary" type="button" onclick="scrollToSection('cart')">
          æŸ¥çœ‹è³¼ç‰©è»Šï¼ˆ0ï¼‰
        </button>
      </div>
    </div>
  </header>

  <main>
    <!-- =========================================================
      Heroï¼ˆé¦–é  Banner / æœå°‹ / ä¸»æ‰“è¼ªæ’­ï¼‰
    ========================================================= -->
    <section class="hero" aria-label="é¦–é ä¸»è¦–è¦º">
      <div class="hero-top">
        <div style="font-size:14px;color:#9a7641;">
          æ­¡è¿ä¾†åˆ° <strong>ä¸‰å°éš»æ—¥å¸¸ç™¾è²¨</strong>
        </div>

        </div>

      <div class="hero-main">
        <div>
          <div class="hero-left-title">æŠŠå–œæ­¡çš„å¯æ„›ï¼Œéƒ½æ”¾é€²æ—¥å¸¸è£¡ã€‚ â™¡</div>
          <div class="hero-left-sub">
            æ¯å­ã€æŠ±æ•ã€å°æ‰˜ç›¤ã€æ¡Œä¸Šå°ç‰©ã€ç”Ÿæ´»ç”¨å“ï¼Œå¯æ„›ä¸æ˜¯è£é£¾ï¼Œæ˜¯ç”Ÿæ´»å¿…éœ€å“ã€‚
          </div>

          <div class="hero-benefits-row">
            <div class="hero-benefit">æ»¿ NT$699 è¶…å•†å…é‹</div>
            <div class="hero-benefit">ç„¡éœ€è¨»å†Šæœƒå“¡ï¼Œä¸€æ¬¡å¡«å¯«å°±èƒ½ä¸‹å–®</div>
            <div class="hero-benefit">ç•™ <span class="hero-pill-text">
æœ¬ç¶²ç«™æš«ä¸æ”¯æŒ<strong style="font-weight:900;">è²¨åˆ°ä»˜æ¬¾</strong>ï¼Œ
<a href="https://shopee.tw/a0931866109?categoryId=100639&entryPoint=ShopByPDP&itemId=47802373263"
   target="_blank"
   style="color:#ee4d2d;font-weight:900;text-decoration:underline;">
å‰å¾€è¦çš®å¯è²¨åˆ°ä»˜æ¬¾
</a>
</span></div>
          </div>

          <div class="hero-actions-row">
            <button class="hero-primary-btn" type="button" onclick="scrollToSection('products')">
              ğŸ›’ é¦¬ä¸Šé€›å…¨éƒ¨å•†å“
            </button>
            <button class="hero-secondary-btn" type="button" onclick="scrollToSection('cart')">
              æŸ¥çœ‹è³¼ç‰©è»Š
            </button>
          </div>

          <div class="hero-left-note">
            å–œæ­¡çš„å•†å“éƒ½å¯ä»¥å…ˆåŠ å…¥è³¼ç‰©è»Šï¼Œ æ¥è‘—åœ¨ã€Œçµå¸³å€ã€ä¸€æ¬¡å¡«å¯«æ”¶ä»¶è³‡æ–™å°±å¯ä»¥å›‰ï¼<br />
			è¨‚å–®æˆç«‹å¾Œï¼Œæˆ‘å€‘æœƒä¾åºç‚ºä½ æº–å‚™å‡ºè²¨<br />
			æœ‰éœ€è¦ç¢ºèªçš„åœ°æ–¹ä¹Ÿæœƒä¸»å‹•èˆ‡ä½ è¯çµ¡ï¼Œè¬è¬ä½ çš„è€å¿ƒç­‰å¾… ğŸ¤
          </div>
        </div>

        <aside class="hero-banner" aria-label="ä¸»æ‰“è¼ªæ’­">
          <div class="hero-banner-slides" id="heroBannerSlides"></div>
          <div class="hero-banner-dots-row">
            <span class="hero-banner-hint">ä¸»æ‰“å•†å“è¼ªæ’­ä¸­ï¼Œå¯é»å°é»åˆ‡æ›ã€‚</span>
            <div class="hero-dots" id="heroBannerDots"></div>
          </div>
        </aside>
      </div>
    
    <!-- =========================================================
      æœå°‹ï¼ˆç§»åˆ°å•†å“åˆ†é¡ä¸Šæ–¹ï¼Œæ‰‹æ©Ÿæ›´å¥½ç”¨ï¼‰
    ========================================================= -->
    <div class="search-strip" aria-label="å•†å“æœå°‹">
      <div class="hero-search">
          <span class="hero-search-icon">ğŸ”</span>
          <input
            id="heroSearchInput"
            type="search"
            placeholder="æƒ³æ‰¾ä»€éº¼å°ç‰©ï¼Ÿä¾‹ï¼šå¸†å¸ƒè¢‹ã€é¦¬å…‹æ¯ã€æ¡Œä¸Šå°ç‰©â€¦"
          />
        </div>
    </div>

</section>

    <!-- =========================================================
      å•†å“åˆ†é¡
    ========================================================= -->
    <section aria-label="å•†å“åˆ†é¡">
      <h3 class="section-title">
        å•†å“åˆ†é¡
        <span>è®“æœ€å–œæ­¡çš„è§’è‰²ï¼Œé™ªä½ éæ¯ä¸€å¤©ã€‚</span>
      </h3>

      <div class="category-row">
        <button class="category-chip active" type="button" data-category="all">å…¨éƒ¨</button>
        <button class="category-chip" type="button" data-category="cup">æ¯ç›¤é¤å…·</button>
        <button class="category-chip" type="button" data-category="room">æˆ¿é–“ä½ˆç½®</button>
        <button class="category-chip" type="button" data-category="desk">æ¡Œä¸Šå°ç‰©</button>
        <button class="category-chip" type="button" data-category="gift">é€ç¦®å°ç‰©</button>
        <button class="category-chip" type="button" data-category="life">ç”Ÿæ´»ç”¨å“</button>
      </div>
    </section>

    <!-- =========================================================
      å•†å“åˆ—è¡¨ï¼ˆç”± JS å‹•æ…‹æ¸²æŸ“ï¼‰
    ========================================================= -->
    <section id="products" aria-label="å•†å“åˆ—è¡¨">
      <h3 class="section-title">
        ç²¾é¸å•†å“
        <span>å•†å“åˆ—è¡¨èˆ‡è©³æƒ…éƒ½å¾åŒä¸€ä»½è³‡æ–™ç”¢ç”Ÿ</span>
      </h3>

      <div class="product-grid" id="productGrid"></div>

      <div id="productEmptyHint" style="
        display:none;
        margin-top: 10px;
        padding: 12px 14px;
        border-radius: 14px;
        background: #fffdf5;
        border: 1px dashed #f0d9a4;
        font-size: 13px;
        color: #7a5c3a;
      ">
        æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„å°ç‰©ï½ğŸ§<br />
        å¯ä»¥è©¦è©¦çœ‹ï¼šæ›å€‹é—œéµå­—ã€ç¸®çŸ­é—œéµå­—ï¼ˆä¾‹å¦‚è¼¸å…¥ã€Œæ¯ã€æˆ–ã€Œå¸†å¸ƒã€ï¼‰ã€‚
      </div>
    </section>

    <!-- =========================================================
      å•†å“è©³æƒ…ï¼ˆé»å•†å“å¾Œé¡¯ç¤ºï¼‰
    ========================================================= -->
    <section class="card product-detail" id="productDetail" aria-label="å•†å“è©³æƒ…">
      <h3 class="section-title">
        <span id="detailTitlePrefix">å•†å“è©³æƒ…ï½œ</span><span id="detailTitleMain"></span>
        <span id="detailSubtitle"> </span>
      </h3>

      <div class="pd-layout">
        <div class="pd-images">
          <div class="pd-main-img">
            <img id="detailMainImg" src="" alt="" />
          </div>
          <div class="pd-thumbs" id="detailThumbs"></div>
        </div>

        <div>
          <div class="pd-info-title" id="detailName"></div>
          <div class="pd-info-sub" id="detailSub"></div>

          <div class="pd-price">
            NT$ <span id="detailPrice">0</span>
            <span id="detailPriceNote"></span>
          </div>

          <div>
            <div class="pd-spec-title">é¸æ“‡æ¬¾å¼</div>
            <div class="pd-spec-options" id="detailSpecs"></div>
          </div>

          <div style="margin-top:8px;display:flex;flex-wrap:wrap;gap:10px;align-items:center;">
            <div class="qty-control" id="detailQtyControl">
              <button type="button" class="qty-btn" id="detailQtyMinus">âˆ’</button>
              <input type="text" class="qty-input" id="detailQtyInput" value="1" />
              <button type="button" class="qty-btn" id="detailQtyPlus">ï¼‹</button>
            </div>

            <button type="button" class="btn-primary" id="detailAddBtn">ğŸ›’ åŠ å…¥è³¼ç‰©è»Š</button>

            <button type="button" class="btn-secondary btn-line" id="detailLineBtn">
              ğŸ’¬ ä½¿ç”¨ LINE è¯ç¹«å°åº—é•·
            </button>

            <button type="button" class="btn-secondary" onclick="backToProducts()">
              â† å›åˆ°å•†å“åˆ—è¡¨
            </button>
          </div>

          <div class="pd-desc-detail" id="detailDesc"></div>
        </div>
      </div>
    </section>

    <!-- =========================================================
      è³¼ç‰©è»Š
    ========================================================= -->
    <section class="card" id="cart" aria-label="è³¼ç‰©è»Š">
      <h3 class="section-title">
        è³¼ç‰©è»Š
        <span>æŸ¥çœ‹ä½ å‰›å‰›åŠ å…¥çš„å°ç‰©</span>
      </h3>

      <div id="cartList" style="font-size:13px; color:#6b502c;">
        ï¼ˆä½ çš„è³¼ç‰©è»Šç›®å‰æ˜¯ç©ºçš„ï¼‰
      </div>

      <div id="cartSummary" style="
        margin-top:10px;
        padding:12px 14px;
        border-radius:14px;
        background:#fffdf5;
        border:1px dashed #f0d9a4;
        font-size:13px;
        color:#4f3b2a;
        display:none;
      ">
        <div style="display:flex;justify-content:space-between;margin:4px 0;">
          <span>å°è¨ˆ</span><strong id="sumSubtotal">NT$ 0</strong>
        </div>
        <div style="display:flex;justify-content:space-between;margin:4px 0;">
          <span>é‹è²» <span style="font-size:13px;color:#9a7641;">(<strong style=\"font-weight:900;\">\1</strong>)</span></span>
          <strong id="sumShipping">NT$ 0</strong>
        </div>
        <div style="display:flex;justify-content:space-between;margin:6px 0;border-top:1px dashed #f0d9a4;padding-top:8px;">
          <span>ç¸½è¨ˆ</span><strong id="sumTotal">NT$ 0</strong>
        </div>
        <div id="shipHint" style="margin-top:6px;font-size:13px;color:#9a7641;"></div>
      </div>

      <div class="form-actions" style="margin-top:14px;">
        <button type="button" class="btn-primary" onclick="scrollToSection('checkout')">
          å‰å¾€çµå¸³
        </button>
        <button type="button" class="btn-secondary" onclick="backToProducts()">
          ç¹¼çºŒé€›é€›
        </button>
      </div>
    </section>

    <!-- =========================================================
      çµå¸³
    ========================================================= -->
    <section class="card" id="checkout" aria-label="çµå¸³">
      <h3 class="section-title">
        çµå¸³è³‡è¨Šï¼ˆç„¡éœ€è¨»å†Šæœƒå“¡ï¼‰
        <span>ä¸€æ¬¡å¡«å¯«ï¼Œä¹‹å¾Œé€é Email / Line é€šçŸ¥ä½ å‡ºè²¨</span>
      </h3>

      <p>
        æˆ‘å€‘ä¸åšè¤‡é›œçš„æœƒå“¡ç³»çµ±ï¼Œåªéœ€è¦ä½ åœ¨é€™è£¡å¡«å¯«ä¸€æ¬¡ï¼Œ<br />
        å°±å¯ä»¥å®Œæˆè¨‚å–®ã€‚<br />
        <strong>Email / Line ID æœƒç”¨ä¾†ï¼š</strong>
      </p>
      <ul>
        <li>é€šçŸ¥ä½ ã€Œè¨‚å–®æˆç«‹ / å‡ºè²¨ / åˆ°åº—æé†’ã€</li>
        <li>å¶çˆ¾åˆ†äº«æ–°å“æˆ–æŠ˜æ‰£ï¼ˆå¯ä»¥è«‹æˆ‘å€‘åœæ­¢é€šçŸ¥ï¼‰</li>
      </ul>

      <form id="checkoutForm">
        <div class="form-row">
          <div>
            <label for="checkoutName">æ”¶ä»¶äººå§“åï¼ˆå¿…å¡«ï¼‰</label>
            <input type="text" id="checkoutName" required />
          </div>
          <div>
            <label for="checkoutPhone">æ‰‹æ©Ÿè™Ÿç¢¼ï¼ˆå¿…å¡«ï¼‰</label>
            <input type="tel" id="checkoutPhone" required placeholder="ä¾‹ï¼š09xxxxxxxx" />
            <div class="form-hint">ä¹‹å¾ŒæŸ¥è¨‚å–®æœƒç”¨åˆ°é€™æ”¯é›»è©±ã€‚</div>
          </div>
        </div>

        <div class="form-row">
          <div>
            <label for="checkoutEmailLocal">Emailï¼ˆå¿…å¡«ï¼‰</label>

            <div style="display:flex;gap:8px;align-items:center;">
              <input
                type="text"
                id="checkoutEmailLocal"
                required
                placeholder="ä¾‹ï¼šyou"
                inputmode="email"
                autocomplete="email"
                style="flex:1;"
              />

              <select id="checkoutEmailDomain" aria-label="é¸æ“‡å¸¸ç”¨ä¿¡ç®±å°¾ç¢¼" style="width:190px;">
                <option value="gmail.com">gmail.com</option>
                <option value="yahoo.com">yahoo.com</option>
                <option value="hotmail.com">hotmail.com</option>
                <option value="outlook.com">outlook.com</option>
                <option value="icloud.com">icloud.com</option>
                <option value="custom">å…¶ä»–â€¦</option>
              </select>
            </div>

            <input
              type="text"
              id="checkoutEmailCustom"
              placeholder="è‡ªè¨‚ç¶²åŸŸï¼Œä¾‹å¦‚ example.com"
              inputmode="email"
              style="margin-top:8px;display:none;"
            />

            <!-- é€å‡ºæ™‚æœƒæŠŠçµ„åˆå¾Œçš„å®Œæ•´ Email æ”¾é€²é€™è£¡ï¼ˆä¿ç•™ä½ åŸæœ¬ payload è®€å– checkoutEmail çš„å¯«æ³•ï¼‰ -->
            <input type="hidden" id="checkoutEmail" />

            <div class="form-hint" id="emailHint">æœƒå¯„é€è¨‚å–®æ˜ç´°èˆ‡å‡ºè²¨é€šçŸ¥ã€‚</div>
          </div>
          <div>
            <label for="checkoutLine">Line IDï¼ˆé¸å¡«ï¼‰</label>
            <input type="text" id="checkoutLine" placeholder="è‹¥å¡«å¯«ï¼Œå°‡å„ªå…ˆç”¨ Line é€šçŸ¥" />
          </div>
        </div>

        <div>
          <label for="checkoutAddress">æ”¶ä»¶åœ°å€ / è¶…å•†é–€å¸‚ï¼ˆå¿…å¡«ï¼‰</label>
          <input type="text" id="checkoutAddress" placeholder="è¶…å•†å–è²¨å¯å¡«ï¼šè¶…å•† + é–€å¸‚åç¨±" />
        
          <div class="form-hint" id="checkoutAddressHint">è«‹å¡«å¯«ï¼šè¶…å•†ï¼ˆ7-11/å…¨å®¶ï¼‰è«‹å¡«ã€Œé–€å¸‚åç¨±ã€ï¼›å®…é…è«‹å¡«å®Œæ•´åœ°å€ã€‚</div>
</div>

        <div class="form-row">
          <div>
            <label for="checkoutShip">é…é€æ–¹å¼</label>
            <select id="checkoutShip">
              <option value="711">è¶…å•†å–è²¨ï¼ˆ7-11ï¼‰</option>
              <option value="family">è¶…å•†å–è²¨ï¼ˆå…¨å®¶ï¼‰</option>
              <option value="home">å®…é…åˆ°åºœ</option>
            </select>
          </div>
          <div>
            <label for="checkoutPay">ä»˜æ¬¾æ–¹å¼</label>
            <select id="checkoutPay">
              <option value="card">ä¿¡ç”¨å¡ï¼ˆç·šä¸Šä»˜æ¬¾ï¼‰</option>
              <option value="linepay">LINE Payï¼ˆç·šä¸Šä»˜æ¬¾ï¼‰</option>
              <option value="cod">è²¨åˆ°ä»˜æ¬¾ï¼ˆæ”¹èµ°è¦çš®ä¸‹å–®ï¼‰</option>
              <option value="transfer" disabled>éŠ€è¡Œè½‰å¸³ï¼ˆæš«ä¸é–‹æ”¾ï¼‰</option>
            </select>
            <div class="form-hint">è²¨åˆ°ä»˜æ¬¾æœƒå¼•å°ä½ åˆ°è¦çš®ä¸‹å–®ï¼›éŠ€è¡Œè½‰å¸³æš«ä¸é–‹æ”¾ï¼ˆä¹‹å¾Œæ”¹è™›æ“¬å¸³æˆ¶ï¼‰ã€‚</div>
          </div>
        </div>

        <div>
          <label for="checkoutNote">å‚™è¨»ï¼ˆé¸å¡«ï¼‰</label>
          <textarea id="checkoutNote" placeholder="ä¾‹å¦‚ï¼šå¸Œæœ›ç›¡é‡å¹«æˆ‘åœ¨ 18:00 å‰é€é”ï¼Œæˆ–æ˜¯å…¶ä»–å°æé†’ã€‚"></textarea>
        </div>

        <div class="form-note">
          â€» ç›®å‰ç‚ºæ¸¬è©¦ç‰ˆï¼šæŒ‰ä¸‹é€å‡ºå¾Œï¼Œæœƒåœ¨ç³»çµ±ä¸­å»ºç«‹ä¸€ç­†è¨‚å–®ç´€éŒ„ï¼Œ<br />
          è‹¥æ˜¯æ­£å¼ç‡Ÿé‹å‰çš„æ¸¬è©¦ï¼Œå¯ä»¥éš¨æ„å¤šè©¦å¹¾æ¬¡æ²’é—œä¿‚ã€‚
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-primary">é€å‡ºè¨‚å–®</button>
          <button type="button" class="btn-secondary" onclick="backToProducts()">
            é‚„æƒ³å†å¤šé€›ä¸€ä¸‹
          </button>
        </div>
      </form>
    </section>

    <!-- =========================================================
      è¯çµ¡ / å‡ºè²¨èªªæ˜
    ========================================================= -->
    <section class="card" id="service-info" aria-label="è¯çµ¡èˆ‡å‡ºè²¨èªªæ˜">
      <h3 class="section-title">
        è¯çµ¡å°åº—é•· & å‡ºè²¨èªªæ˜
        <span>æœ‰å•é¡Œã€æƒ³è¿½è¹¤è¨‚å–®éƒ½å¯ä»¥æ‰¾æˆ‘å€‘</span>
      </h3>

      <div style="display:flex;flex-wrap:wrap;gap:18px;align-items:flex-start;">
        <div style="flex:2;min-width:220px;font-size:13px;color:#6b502c;">
          <p style="margin-bottom:6px;">
            æœ‰ä»»ä½•å•†å“å•é¡Œã€æƒ³ç¢ºèªåº«å­˜ã€ä¿®æ”¹è¨‚å–®è³‡æ–™ï¼Œ<br />
            éƒ½å¯ä»¥é€é <strong>å®˜æ–¹ LINE</strong> æˆ– <strong>è¦çš®èŠèŠ</strong> æ‰¾ä¸‰å°éš»å°åº—é•·ã€‚
          </p>

          <p style="margin-bottom:4px;">
            <strong>å®¢æœæ™‚é–“ï¼š</strong><br />
            å¹³æ—¥ï¼š<span>13:00 â€“ 22:00</span><br />
            å‡æ—¥ï¼šè¦–å‡ºè²¨ç‹€æ³ä¸å®šæ™‚å›è¦†ï¼ˆé€šå¸¸ä¹Ÿæœƒå·çœ‹è¨Šæ¯ ğŸ˜†ï¼‰
          </p>

          <p style="margin-bottom:4px;">
            <strong>å‡ºè²¨èªªæ˜ï¼š</strong><br />
            ãƒ»ä¸‹å–®å¾Œç´„ <strong>1â€“3 å€‹å·¥ä½œå¤©</strong> å‡ºè²¨ï¼ˆé‡é€£å‡å¯èƒ½é †å»¶ï¼‰<br />
            ãƒ»è¶…å•†å–è²¨ç´„å† 1â€“3 å¤©åˆ°åº—ï¼Œå®…é…ç´„ 1â€“3 å¤©é€é”<br />
            ãƒ»è‹¥æœ‰æ€¥ä»¶æˆ–æŒ‡å®šæ™‚é–“ï¼Œå¯ä»¥å…ˆ LINE ç§è¨Šè¨è«–<br />
            ãƒ»è¼ƒé•·å‚™è²¨ç‚º 12-15 å¤©å‡ºè²¨
          </p>

          <p style="margin-top:6px;">
            <strong>å°æé†’ï¼š</strong>çµå¸³å®Œæˆå¾Œï¼Œ<br />
            ä¹Ÿå¯ä»¥ Screenshot è¨‚å–® + åŠ å…¥ LINEï¼Œæ–¹ä¾¿æˆ‘å€‘å”åŠ©æŸ¥è©¢èˆ‡è¿½è¹¤ã€‚
          </p>
        </div>

        <div style="
          display:inline-block;
          padding:12px 14px;
          border-radius:16px;
          background:#fffdf7;
          border:1px solid #f0d9a4;
          box-shadow:0 2px 4px rgba(0,0,0,0.04);
        ">
          <img
            src="basic-images/line-qr.png"
            alt="å®˜æ–¹ LINE QR Code"
            style="width:140px;height:140px;border-radius:12px;"
          />
          <div style="margin-top:8px;font-size:14px;color:#6b502c;">
            å®˜æ–¹ LINE IDï¼š<br />
            <strong style="font-size:17px;color:#00b43c;">@301gfuh</strong>
          </div>
        </div>

        <div style="margin-top:10px;display:flex;flex-direction:column;gap:8px;align-items:center;">
          <a
            href="https://lin.ee/FDKoij6"
            target="_blank"
            rel="noopener noreferrer"
            style="
              display:inline-flex;
              align-items:center;
              gap:6px;
              padding:8px 14px;
              border-radius:999px;
              background:#e4ffe9;
              border:1px solid #8cd49d;
              font-size:13px;
              color:#2f6b3f;
              text-decoration:none;
              font-weight:600;
            "
          >
            <span style="
              width:20px;height:20px;border-radius:999px;
              background:#00b43c;color:#fff;
              display:flex;align-items:center;justify-content:center;
              font-size:13px;
            ">L</span>
            <span>åŠ å…¥ LINE è©¢å• / è¿½è¹¤è¨‚å–®</span>
          </a>

          <a
            href="https://shopee.tw/a0931866109?categoryId=100639&entryPoint=ShopByPDP&itemId=47802373263"
            target="_blank"
            rel="noopener noreferrer"
            style="
              display:inline-flex;
              align-items:center;
              gap:6px;
              padding:8px 14px;
              border-radius:999px;
              background:#fff0e8;
              border:1px solid #f7a27a;
              font-size:13px;
              color:#b8481e;
              text-decoration:none;
              font-weight:600;
            "
          >
            <span style="
              width:20px;height:20px;border-radius:999px;
              background:#ff5b1f;color:#fff;
              display:flex;align-items:center;justify-content:center;
              font-size:13px;
            ">ğŸ›’</span>
            <span>å‰å¾€è¦çš®è³£å ´çœ‹çœ‹</span>
          </a>
        </div>
      </div>
    </section>

    <!-- =========================================================
      è¨‚å–®æŸ¥è©¢
    ========================================================= -->
    <section class="card" id="order-query" aria-label="è¨‚å–®æŸ¥è©¢">
      <h3 class="section-title">
        è¨‚å–®æŸ¥è©¢
        <span>è¼¸å…¥é›»è©±èˆ‡è¨‚å–®ç·¨è™Ÿï¼Œè‡ªè¡ŒæŸ¥çœ‹è¨‚å–®ç‹€æ…‹</span>
      </h3>

      <p>
        ä¹‹å¾ŒçœŸæ­£ä¸Šç·šæ™‚ï¼Œé¡§å®¢å¯ä»¥åœ¨é€™è£¡ç”¨ï¼š<br />
        <strong>æ‰‹æ©Ÿè™Ÿç¢¼ + è¨‚å–®ç·¨è™Ÿ</strong> æŸ¥è©¢è‡ªå·±çš„è¨‚å–®ï¼Œä¸éœ€è¦ç™»å…¥æœƒå“¡ã€‚
      </p>

      <form id="orderQueryForm">
        <div class="form-row">
          <div>
            <label for="queryPhone">æ‰‹æ©Ÿè™Ÿç¢¼</label>
            <input type="tel" id="queryPhone" required placeholder="ä¾‹ï¼š09xxxxxxxx" />
          </div>
          <div>
            <label for="queryOrderId">è¨‚å–®ç·¨è™Ÿ</label>
            <input type="text" id="queryOrderId" required placeholder="ä¾‹ï¼šND20250001" />
          </div>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-primary">æŸ¥è©¢è¨‚å–®</button>
          <div class="form-hint"></div>
        </div>
      </form>

      <div class="order-result" id="orderResult"></div>
    </section>

    <!-- =========================================================
      å“ç‰Œæ•…äº‹
    ========================================================= -->
    <section class="card" id="about" aria-label="å“ç‰Œæ•…äº‹">
      <h3 class="section-title">
        å“ç‰Œå°æ•…äº‹
        <span>è®“å–œæ­¡çš„å¯æ„›ï¼Œä½é€²ä½ çš„æ—¥å¸¸</span>
      </h3>

      <p>
        ä¸‰å°éš»æ—¥å¸¸ç™¾è²¨ï¼Œæ˜¯å¾ä¸€é–“å°æˆ¿é–“æ…¢æ…¢é•·å‡ºä¾†çš„å°å°é¸ç‰©åº—ã€‚<br />
        èµ·åˆåªæ˜¯æƒ³è®“ç”Ÿæ´»è®Šå¾—æŸ”è»Ÿä¸€é»â€”â€”ä¹Ÿè¨±æ˜¯ä¸€å€‹å¥¶æ²¹è‰²çš„æ¯å­ã€<br />
        ä¸€å€‹å¯æ„›è§’è‰²çš„å°æ“ºé£¾ã€æˆ–æ˜¯ä¸€å€‹æ”¾åœ¨æ¡Œä¸Šå°±æœƒè®“å¿ƒæƒ…éœä¸‹ä¾†çš„å°ç‰©ã€‚
      </p>

      <p>
        æ¼¸æ¼¸åœ°æˆ‘å€‘ç™¼ç¾ï¼Œ<strong>å¯æ„›ä¸æ˜¯å¤šé¤˜ï¼Œè€Œæ˜¯ä¸€ç¨®èƒ½è®“æ—¥å­è®Šæº«æŸ”çš„åŠ›é‡ã€‚</strong><br />
        å–œæ­¡çš„è§’è‰²é™ªè‘—ä½ ã€é †çœ¼çš„é¡è‰²é»äº®æˆ¿é–“ã€å¥½ç”¨çš„å°ç‰©è®“ç”Ÿæ´»æ›´è¼•é¬†ï¼Œ<br />
        é‚£äº›å¾®å°ã€å»çœŸå¯¦çš„ç¾å¥½ï¼Œå°±æ˜¯ä¸‰å°éš»å­˜åœ¨çš„åŸå› ã€‚
      </p>

      <p>
        æ‰€ä»¥æˆ‘å€‘æŠŠå‹•ç•«å‘¨é‚Šã€ç”Ÿæ´»å°ç‰©èˆ‡ç™‚ç™’é¸ç‰©é›†åˆåœ¨ä¸€èµ·ï¼Œç²¾æŒ‘ç´°é¸ï¼Œ<br />
        åªå¸Œæœ›æ¯ä¸€æ¨£é€åˆ°ä½ æ‰‹ä¸Šçš„ï¼Œä¸åªæ˜¯ç‰©å“ï¼Œè€Œæ˜¯ä¸€ä»½å‰›å‰›å¥½çš„é™ªä¼´ã€‚
      </p>

      <ul>
        <li>è¦ªè‡ªæŒ‘é¸ã€å¯¦æ‹å¯¦ç”¨ï¼Œä¸åªçœ‹å» å•†ç…§ç‰‡ã€‚</li>
        <li>ä»¥å¥¶æ²¹é»ƒã€å¥¶èŒ¶è‰²ã€æœ¨é ­è‰²ç­‰æŸ”å’Œè‰²ç³»ç‚ºä¸»ï¼Œè®“ç©ºé–“æ›´èˆ’æœã€‚</li>
        <li>åƒ¹æ ¼è¨­å®šåœ¨ã€Œè‡ªå·±ä¹Ÿæœƒé¡˜æ„è²·ã€çš„ç¯„åœå…§ã€‚</li>
      </ul>

      <p>
        å¸Œæœ›ä½ æ‰“é–‹åŒ…è£¹çš„é‚£ä¸€åˆ»ï¼Œèƒ½æ„Ÿå—åˆ°é‚£ä¸€é»é»æº«æš–ï¼š<br />
        <strong>å•Šï¼Œä»Šå¤©çš„ç”Ÿæ´»ï¼Œåˆå¤šäº†ä¸€é»å–œæ­¡çš„ç†ç”±ã€‚ğŸ§ˆ</strong>
      </p>
    </section>
  </main>

  <footer>
    ä¸‰å°éš»æ—¥å¸¸ç™¾è²¨ï½œç™‚ç™’ç”Ÿæ´»ç™¾è²¨ Â· ç„¡æœƒå“¡åˆ¶é›»å•†ç¶²ç«™ç¤ºæ„ç‰ˆå‹<br />
    è¯çµ¡ä¿¡ç®±:b123027869@gmail.com<br />
	é€£çµ¡é›»è©±:0985675489
	åœ°å€:é«˜é›„å¸‚å½Œé™€å€æµ·å°¾é‡Œæµ·å°¾è·¯62è™Ÿä¹‹1
  </footer>

  <!-- å³ä¸‹è§’è£é£¾ -->
  <div class="sxz-cloud-buddies" aria-hidden="true">
    <div class="sxz-cloud"></div>
    <div class="sxz-buddy sxz-buddy-1"></div>
    <div class="sxz-buddy sxz-buddy-2"></div>
    <div class="sxz-buddy sxz-buddy-3"></div>
    <div class="sxz-stick"></div>
  </div>

  <!-- Lightbox -->
  <div id="imgLightbox" class="lb" aria-hidden="true">
    <button class="lb-close" id="lbClose" type="button" aria-label="é—œé–‰">âœ•</button>
    <button class="lb-nav lb-prev" id="lbPrev" type="button" aria-label="ä¸Šä¸€å¼µ">â€¹</button>
    <div class="lb-stage" id="lbStage">
      <img id="lbImg" alt="å•†å“åœ–ç‰‡æ”¾å¤§" />
    </div>
    <button class="lb-nav lb-next" id="lbNext" type="button" aria-label="ä¸‹ä¸€å¼µ">â€º</button>
    <div class="lb-hint" id="lbHint">é»æ“Šç©ºç™½è™•æˆ–æŒ‰ ESC é—œé–‰ï½œå·¦å³éµåˆ‡æ›ï½œæ‰‹æ©Ÿå¯å·¦å³æ»‘</div>
  </div>

  <script>
    /* =========================================================
      A) å¸¸æ•¸è¨­å®šï¼ˆåœ–ç‰‡ / APIï¼‰
    ========================================================= */
    const SUPABASE_IMG_BASE =
      "https://ckqdimygblkasofycwvr.supabase.co/storage/v1/object/public/product-images/";

    function resolveImgUrl(url) {
      if (!url) return "";
      if (/^https?:\/\//i.test(url)) return url;
      return SUPABASE_IMG_BASE + url.replace(/^\/+/, "");
    }

// Shopee ä¸‹å–®é€£çµï¼ˆç”¨æ–¼ã€Œè²¨åˆ°ä»˜æ¬¾ã€å¼•å°ï¼‰
    const SHOPEE_COD_URL = "https://shopee.tw/a0931866109?categoryId=100639&entryPoint=ShopByPDP&itemId=47802373263";

    const API_BASE =
      (location.hostname === 'localhost' || location.hostname === '127.0.0.1')
        ? 'http://localhost:3000'
        : location.origin;

    async function apiPost(path, data) {
      const res = await fetch(API_BASE + path, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      });

      if (!res.ok) {
        const text = await res.text().catch(() => "");
        throw new Error("API éŒ¯èª¤ï¼š" + res.status + " " + text);
      }
      return res.json();
    }

    async function apiGet(path) {
      const res = await fetch(API_BASE + path);
      if (!res.ok) {
        const text = await res.text().catch(() => "");
        throw new Error("API éŒ¯èª¤ï¼š" + res.status + " " + text);
      }
      return res.json();
    }

    function scrollToSection(id) {
      const el = document.getElementById(id);
      if (el) el.scrollIntoView({ behavior: "smooth" });
    }

    /* =========================================================
      B) å•†å“è³‡æ–™èˆ‡ç¯©é¸ç‹€æ…‹
    ========================================================= */
    let products = [];
    let currentCategory = "all";
    let currentKeyword = "";

    const productGrid = document.getElementById("productGrid");
    const productEmptyHint = document.getElementById("productEmptyHint");
    const heroSearchInput = document.getElementById("heroSearchInput");

    async function loadProducts() {
      try {
        const data = await apiGet("/api/products");
        const list = data.products || data.data || [];
        products = Array.isArray(list) ? list : [];
      } catch (err) {
        console.error("è¼‰å…¥å•†å“å¤±æ•—", err);
        products = [];
        alert("è¼‰å…¥å•†å“å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ä¸€æ¬¡ï¼Œæˆ–ç¢ºèªå¾Œç«¯ /api/products æ˜¯å¦æœ‰é–‹å•Ÿã€‚");
      }
    }

    /* =========================================================
      C) åˆ†é¡åˆ‡æ›
    ========================================================= */
    const categoryChips = document.querySelectorAll(".category-chip");
    categoryChips.forEach((chip) => {
      chip.addEventListener("click", () => {
        categoryChips.forEach((c) => c.classList.remove("active"));
        chip.classList.add("active");
        currentCategory = chip.dataset.category || "all";
        renderProductGrid();
      });
    });

    /* =========================================================
      D) æœå°‹
    ========================================================= */
    if (heroSearchInput) {
      heroSearchInput.addEventListener("input", () => {
        const value = heroSearchInput.value || "";
        currentKeyword = value;
        renderProductGrid();
      });

      heroSearchInput.addEventListener("focus", () => {
        scrollToSection("products");
      });
    }

    /* =========================================================
      E) è³¼ç‰©è»Šç‹€æ…‹
    ========================================================= */
    let cartItems = [];
    let cartCount = 0;
    const cartBtnTop = document.querySelector(".nav-action .btn-primary");

    function updateCartBtnText() {
      if (cartBtnTop) cartBtnTop.textContent = `æŸ¥çœ‹è³¼ç‰©è»Šï¼ˆ${cartCount}ï¼‰`;
    }

    function calcCartTotal() {
      return cartItems.reduce((sum, it) => {
        const price = typeof it.price === "number" ? it.price : 0;
        return sum + price * it.qty;
      }, 0);
    }

    function addToCart(productId, specKey, qty) {
      const product = products.find((p) => p.id === productId);
      if (!product) return;

      const specList = product.specs || [];
      let useSpec = specList[0];

      if (specKey) {
        const found = specList.find((s) => s.key === specKey);
        if (found) useSpec = found;
      }

      if (!useSpec) useSpec = { key: "default", label: "é è¨­æ¬¾" };

      qty = Number(qty) || 1;
      if (qty < 1) qty = 1;

      if (typeof useSpec.stock === "number") {
        const currentInCartSpec = cartItems
          .filter((it) => it.productId === productId && it.specKey === useSpec.key)
          .reduce((sum, it) => sum + it.qty, 0);

        if (currentInCartSpec + qty > useSpec.stock) {
          const remain = useSpec.stock - currentInCartSpec;
          alert(
            `ã€Œ${product.name} - ${useSpec.label}ã€åº«å­˜ä¸è¶³ï¼Œ` +
            `ç›®å‰æœ€å¤šé‚„èƒ½åŠ  ${remain < 0 ? 0 : remain} ä»¶ã€‚`
          );
          return;
        }
      }

      const exist = cartItems.find(
        (item) => item.productId === productId && item.specKey === useSpec.key
      );

      if (exist) {
        exist.qty += qty;
      } else {
        cartItems.push({
          productId,
          specKey: useSpec.key,
          name: product.name,
          specLabel: useSpec.label,
          price: product.price,
          qty,
        });
      }

      cartCount = cartItems.reduce((sum, it) => sum + it.qty, 0);
      updateCartBtnText();
      renderCart();
    }

    function removeCartItem(index) {
      if (index < 0 || index >= cartItems.length) return;
      cartItems.splice(index, 1);
      cartCount = cartItems.reduce((sum, it) => sum + it.qty, 0);
      updateCartBtnText();
      renderCart();
    }
    window.removeCartItem = removeCartItem;

    function renderCart() {
      const container = document.getElementById("cartList");
      if (!container) return;

      if (cartItems.length === 0) {
        container.innerHTML = "ï¼ˆä½ çš„è³¼ç‰©è»Šç›®å‰æ˜¯ç©ºçš„ï¼‰";
        updateCartSummary();
        return;
      }

      let html = '<ul style="padding-left:18px;">';

      cartItems.forEach((item, index) => {
        const lineTotal = item.price * item.qty;
        html += `
          <li style="margin-bottom:4px;">
            ${item.name}ï¼ˆ${item.specLabel}ï¼‰ Ã— ${item.qty}
            ï¼ NT$${lineTotal}
            <button type="button"
              onclick="removeCartItem(${index})"
              style="margin-left:6px;padding:2px 6px;font-size:11px;border-radius:6px;border:1px solid #e0c080;background:#fff9ec;cursor:pointer;">
              ç§»é™¤
            </button>
          </li>
        `;
      });

      html += "</ul>";
      container.innerHTML = html;

      updateCartSummary();
    }

    function updateCartSummary() {
      const summary = document.getElementById("cartSummary");
      if (!summary) return;

      const subtotalEl = document.getElementById("sumSubtotal");
      const shipEl = document.getElementById("sumShipping");
      const totalEl = document.getElementById("sumTotal");
      const hintEl = document.getElementById("shipHint");
      const shipMethodEl = document.getElementById("checkoutShip");

      const subtotal = calcCartTotal();
      const freeShipThreshold = 699;

      let shipping = 0;
      const shipMethod = shipMethodEl ? shipMethodEl.value : "711";
      if (subtotal === 0) shipping = 0;
      else if (subtotal >= freeShipThreshold) shipping = 0;
      else {
        shipping =
          shipMethod === "home" ? 100 :
          shipMethod === "family" ? 60 :
          60;
      }

      const total = subtotal + shipping;

      summary.style.display = subtotal > 0 ? "block" : "none";
      if (subtotalEl) subtotalEl.textContent = `NT$ ${subtotal}`;
      if (shipEl) shipEl.textContent = `NT$ ${shipping}`;
      if (totalEl) totalEl.textContent = `NT$ ${total}`;

      if (hintEl) {
        if (subtotal === 0) hintEl.textContent = "";
        else if (subtotal >= freeShipThreshold) hintEl.textContent = "å·²é”å…é‹é–€æª»ï¼Œå¤ªæ£’äº†ï½ğŸ¥³";
        else hintEl.textContent = `å†è²· NT$ ${freeShipThreshold - subtotal} å³å¯å…é‹ ğŸ’›`;
      }
    }

    /* =========================================================
      G) å•†å“åˆ—è¡¨æ¸²æŸ“
    ========================================================= */
    function renderProductGrid() {
      if (!productGrid) return;
      productGrid.innerHTML = "";

      const kw = (currentKeyword || "").trim().toLowerCase();

      const filtered = (products || []).filter((product) => {
        const cats = product.categories || [];
        if (currentCategory !== "all" && !cats.includes(currentCategory)) return false;
        if (!kw) return true;

        const text = [
          product.name || "",
          product.subtitle || "",
          (product.categories || []).join(" "),
          product.shortDesc || "",
          product.detailHtml || "",
          product.code || "",
        ].join(" ").toLowerCase();

        return text.includes(kw);
      });

      if (productEmptyHint) productEmptyHint.style.display = filtered.length === 0 ? "block" : "none";
      if (filtered.length === 0) return;

      filtered.forEach((product) => {
        const cats = product.categories || [];
        const specs = product.specs || [];
        const firstSpec = specs[0];

        const mainImgRaw =
          product.imageUrl ||
          (firstSpec && firstSpec.mainImg) ||
          (firstSpec && firstSpec.thumbs && firstSpec.thumbs[0]) ||
          "";

        const mainImg = resolveImgUrl(mainImgRaw);

        const article = document.createElement("article");
        article.className = "product-card";
        article.dataset.id = product.id;
        article.dataset.category = cats.join(" ");
        article.dataset.selectedSpec = firstSpec ? firstSpec.key : "";

        article.innerHTML = `
          ${product.tag ? `<div class="product-tag">${product.tag}</div>` : ""}
          <div class="product-img" data-click="open-detail">
            ${mainImg ? `<img src="${mainImg}" alt="${product.name}">` : ""}
          </div>
          <h4 class="product-name" data-click="open-detail">${product.name}</h4>

          <div class="product-bottom">
            <div class="product-price-row">
              <div class="product-price">NT$ ${product.price}</div>
              <button type="button" class="product-like-btn">â™¡</button>
            </div>

            <div class="card-spec-row">
              ${(specs || [])
                .map(
                  (spec, idx) => `
                    <button type="button"
                      class="card-spec-btn ${idx === 0 ? "active" : ""}"
                      data-spec-key="${spec.key}">
                      ${spec.label}
                    </button>
                  `
                )
                .join("")}
            </div>

            <div class="card-action-row">
              <div class="qty-control">
                <button type="button" class="qty-btn">âˆ’</button>
                <input type="text" class="qty-input" value="1">
                <button type="button" class="qty-btn">ï¼‹</button>
              </div>
              <button type="button" class="btn-cart">ğŸ›’ åŠ å…¥</button>
            </div>
          </div>
        `;

        article.querySelectorAll('[data-click="open-detail"]').forEach((el) => {
          el.addEventListener("click", () => openProduct(product.id));
        });

        const likeBtn = article.querySelector(".product-like-btn");
        likeBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          likeBtn.classList.toggle("active");
          likeBtn.textContent = likeBtn.classList.contains("active") ? "â¤" : "â™¡";
        });

        const specBtns = article.querySelectorAll(".card-spec-btn");
        specBtns.forEach((btn) => {
          btn.addEventListener("click", (e) => {
            e.stopPropagation();
            specBtns.forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            article.dataset.selectedSpec = btn.dataset.specKey || "";
          });
        });

        const qtyInput = article.querySelector(".qty-input");
        const qtyBtns = article.querySelectorAll(".qty-btn");

        qtyBtns[0].addEventListener("click", (e) => {
          e.stopPropagation();
          let v = parseInt(qtyInput.value || "1", 10);
          if (isNaN(v) || v < 1) v = 1;
          qtyInput.value = Math.max(1, v - 1);
        });

        qtyBtns[1].addEventListener("click", (e) => {
          e.stopPropagation();
          let v = parseInt(qtyInput.value || "1", 10);
          if (isNaN(v) || v < 1) v = 1;
          qtyInput.value = v + 1;
        });

        const addBtn = article.querySelector(".btn-cart");
        addBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          const specKey = article.dataset.selectedSpec || "";
          const qty = parseInt(qtyInput.value || "1", 10) || 1;
          addToCart(product.id, specKey, qty);
        });

        productGrid.appendChild(article);
      });
    }

    /* =========================================================
      H) å•†å“è©³æƒ…
    ========================================================= */
    const productDetailSection = document.getElementById("productDetail");
    const detailTitleMain = document.getElementById("detailTitleMain");
    const detailSubtitle = document.getElementById("detailSubtitle");
    const detailName = document.getElementById("detailName");
    const detailSub = document.getElementById("detailSub");
    const detailPrice = document.getElementById("detailPrice");
    const detailPriceNote = document.getElementById("detailPriceNote");
    const detailMainImg = document.getElementById("detailMainImg");
    const detailThumbs = document.getElementById("detailThumbs");
    const detailSpecs = document.getElementById("detailSpecs");
    const detailDesc = document.getElementById("detailDesc");
    const detailQtyInput = document.getElementById("detailQtyInput");
    const detailQtyMinus = document.getElementById("detailQtyMinus");
    const detailQtyPlus = document.getElementById("detailQtyPlus");
    const detailAddBtn = document.getElementById("detailAddBtn");
    const detailLineBtn = document.getElementById("detailLineBtn");
    const heroSection = document.querySelector(".hero");

    let currentDetailProductId = null;
    let currentDetailSpecKey = null;

    function openProduct(productId) {
      const product = products.find((p) => p.id === productId);
      if (!product) return;

      currentDetailProductId = productId;

      detailTitleMain.textContent = product.name;
      detailSubtitle.textContent = product.subtitle ? product.subtitle : "";
      detailName.textContent = product.name;
      detailSub.textContent = product.subtitle || "";
      detailPrice.textContent = product.price;
      detailPriceNote.textContent = product.priceNote || "";
      detailDesc.innerHTML = product.detailHtml || "";

      detailSpecs.innerHTML = "";
      (product.specs || []).forEach((spec, idx) => {
        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "pd-spec-btn" + (idx === 0 ? " active" : "");
        btn.textContent = spec.label;
        btn.dataset.specKey = spec.key;
        btn.addEventListener("click", () => setDetailSpec(productId, spec.key));
        detailSpecs.appendChild(btn);
      });

      if (product.specs && product.specs[0]) {
        setDetailSpec(productId, product.specs[0].key);
      }

      detailQtyInput.value = "1";
      productDetailSection.style.display = "block";

      if (heroSection) heroSection.style.display = "none";
      scrollToSection("productDetail");
    }

    function setDetailSpec(productId, specKey) {
      const product = products.find((p) => p.id === productId);
      if (!product) return;

      const specs = product.specs || [];
      const spec = specs.find((s) => s.key === specKey) || specs[0];
      if (!spec) return;

      currentDetailSpecKey = spec.key;

      const mainImgRaw =
        spec.mainImg ||
        product.imageUrl ||
        (spec.thumbs && spec.thumbs[0]) ||
        "";

      const mainImg = resolveImgUrl(mainImgRaw);
      detailMainImg.src = mainImg;
      detailMainImg.alt = `${product.name} ${spec.label}`;

      detailThumbs.innerHTML = "";
      const thumbList = spec.thumbs && spec.thumbs.length > 0 ? spec.thumbs : [mainImgRaw];

      thumbList.forEach((srcRaw, idx) => {
        if (!srcRaw) return;
        const src = resolveImgUrl(srcRaw);

        const btn = document.createElement("button");
        btn.type = "button";
        btn.className = "pd-thumb-btn" + (idx === 0 ? " active" : "");

        const img = document.createElement("img");
        img.src = src;
        img.alt = `${product.name} ${spec.label} åœ–ç‰‡`;

        btn.appendChild(img);
        btn.addEventListener("click", () => {
          detailMainImg.src = src;
          detailThumbs.querySelectorAll(".pd-thumb-btn").forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
        });

        detailThumbs.appendChild(btn);
      });

      detailSpecs.querySelectorAll(".pd-spec-btn").forEach((btn) => {
        btn.classList.toggle("active", btn.dataset.specKey === specKey);
      });
    }

    function backToProducts() {
      productDetailSection.style.display = "none";
      if (heroSection) heroSection.style.display = "block";
      scrollToSection("products");
    }
    window.backToProducts = backToProducts;

    detailQtyMinus.addEventListener("click", () => {
      let v = parseInt(detailQtyInput.value || "1", 10);
      if (isNaN(v) || v < 1) v = 1;
      detailQtyInput.value = Math.max(1, v - 1);
    });

    detailQtyPlus.addEventListener("click", () => {
      let v = parseInt(detailQtyInput.value || "1", 10);
      if (isNaN(v) || v < 1) v = 1;
      detailQtyInput.value = v + 1;
    });

    detailAddBtn.addEventListener("click", () => {
      if (!currentDetailProductId) return;
      const qty = parseInt(detailQtyInput.value || "1", 10) || 1;
      addToCart(currentDetailProductId, currentDetailSpecKey, qty);
    });

    detailLineBtn.addEventListener("click", () => {
      window.open("https://line.me/R/ti/p/@301gfuh", "_blank");
    });

    /* =========================================================
      I) çµå¸³ï¼šé€å‡ºè¨‚å–®
    ========================================================= */
    const checkoutForm = document.getElementById("checkoutForm");
    if (checkoutForm) {
      checkoutForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        if (cartItems.length === 0) {
          alert("è³¼ç‰©è»Šæ˜¯ç©ºçš„ï¼Œè«‹å…ˆé¸å¹¾æ¨£å°ç‰©å†ä¾†çµå¸³å”·ï¼");
          renderCart();
          updateCartSummary();
          scrollToSection("cart");
          return;
        }

        const name = document.getElementById("checkoutName").value.trim();
        const phone = document.getElementById("checkoutPhone").value.trim();
        const emailLocalRaw = (document.getElementById("checkoutEmailLocal")?.value || "").trim();
        const emailDomainSel = document.getElementById("checkoutEmailDomain")?.value || "gmail.com";
        const emailCustomRaw = (document.getElementById("checkoutEmailCustom")?.value || "").trim();

        // âœ… Email çµ„åˆï¼šå‰åŠæ®µ + å¸¸ç”¨å°¾ç¢¼ï¼ˆæˆ–è‡ªè¨‚ï¼‰
        const emailLocal = emailLocalRaw.replace(/\s+/g, "").replace(/@.*/g, "");
        const domain = (emailDomainSel === "custom" ? emailCustomRaw : emailDomainSel)
          .replace(/^@+/, "")
          .replace(/\s+/g, "");
        const email = (emailLocal && domain) ? `${emailLocal}@${domain}` : "";
        const hiddenEmailEl = document.getElementById("checkoutEmail");
        if (hiddenEmailEl) hiddenEmailEl.value = email;
        const lineId = document.getElementById("checkoutLine").value.trim();
        const address = document.getElementById("checkoutAddress").value.trim();
        const ship = document.getElementById("checkoutShip").value;
        const pay = document.getElementById("checkoutPay").value;
        // âœ… ä»˜æ¬¾æ–¹å¼åˆ†æµ
        // 1) è²¨åˆ°ä»˜æ¬¾ï¼šä¸åœ¨æœ¬ç«™æˆç«‹è¨‚å–®ï¼Œæ”¹å¼•å°åˆ°è¦çš®ä¸‹å–®ï¼ˆé¿å…æ£„å–®é€ æˆé‹è²»æå¤±ï¼‰
        if (pay === "cod") {
          const ok = confirm(
            "è²¨åˆ°ä»˜æ¬¾ç›®å‰åƒ…æä¾›åœ¨è¦çš®ä¸‹å–®ï¼ˆé¿å…æ£„å–®é€ æˆé‹è²»æå¤±ï¼‰ã€‚\n\n" +
            "æŒ‰ã€Œç¢ºå®šã€å‰å¾€è¦çš®ä¸‹å–®ï¼›æŒ‰ã€Œå–æ¶ˆã€å¯æ”¹é¸å…¶ä»–ä»˜æ¬¾æ–¹å¼ã€‚"
          );
          if (ok) window.open(SHOPEE_COD_URL, "_blank", "noopener,noreferrer");
          return;
        }

        // 2) éŠ€è¡Œè½‰å¸³ï¼šå…ˆä¿ç•™ä½†æš«ä¸é–‹æ”¾ï¼ˆé¿å…ç¬¬ä¸‰æ–¹è©é¨™ï¼‰
        if (pay === "transfer") {
          alert("éŠ€è¡Œè½‰å¸³ç›®å‰æš«ä¸é–‹æ”¾ï¼Œä¹‹å¾Œæœƒæ”¹æˆã€Œè™›æ“¬å¸³æˆ¶ã€å†ä¸Šç·šã€‚\n\nè«‹å…ˆæ”¹é¸ï¼šä¿¡ç”¨å¡ / LINE Payï¼Œæˆ–æ”¹èµ°è¦çš®ä¸‹å–®ã€‚");
          return;
        }

        const note = document.getElementById("checkoutNote").value.trim();

        // âœ… åŸºæœ¬å¿…å¡«
if (!name || !phone || !email) {
  alert("å§“åã€é›»è©±ã€Email ç‚ºå¿…å¡«æ¬„ä½ï¼Œè«‹å†ç¢ºèªä¸€ä¸‹å”·ï½");
  return;
}

        // âœ… Email æ ¼å¼é˜²å‘†
        const emailOk = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test(email);
        if (!emailOk) {
          alert("Email æ ¼å¼çœ‹èµ·ä¾†ä¸æ­£ç¢ºï¼Œè«‹å†ç¢ºèªä¸€ä¸‹ï¼ˆä¾‹å¦‚ï¼šyou@gmail.comï¼‰");
          return;
        }


// âœ… å°ç£æ‰‹æ©Ÿï¼š09 + 10 ç¢¼
const phoneDigits = phone.replace(/\D/g, "");
if (!/^09\d{8}$/.test(phoneDigits)) {
  alert("æ‰‹æ©Ÿè™Ÿç¢¼æ ¼å¼ä¸æ­£ç¢ºï¼Œè«‹è¼¸å…¥ 09 é–‹é ­çš„ 10 ç¢¼æ‰‹æ©Ÿè™Ÿç¢¼ï¼ˆä¾‹ï¼š0912345678ï¼‰");
  document.getElementById("checkoutPhone").focus();
  return;
}

// âœ… Email æ ¼å¼
if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
  alert("Email æ ¼å¼ä¸æ­£ç¢ºï¼Œè«‹å†ç¢ºèªä¸€ä¸‹ï¼ˆä¾‹ï¼šyou@gmail.comï¼‰");
  document.getElementById("checkoutEmail").focus();
  return;
}

// âœ… é…é€æ–¹å¼é˜²å‘†ï¼šè¶…å•†/å®…é…éƒ½å¿…å¡«åœ°å€ï¼ˆè¶…å•†å¡«é–€å¸‚ï¼‰
const addressEl = document.getElementById("checkoutAddress");
const addr = (address || "").trim();
if (ship === "home") {
  if (addr.length < 6) {
    alert("å®…é…åˆ°åºœè«‹å¡«å¯«å®Œæ•´æ”¶ä»¶åœ°å€ï¼ˆè‡³å°‘ 6 å€‹å­—ï¼‰ã€‚");
    addressEl.focus();
    return;
  }
} else if (ship === "711" || ship === "family") {
  if (addr.length < 2) {
    alert("è¶…å•†å–è²¨è«‹å¡«å¯«ã€Œé–€å¸‚åç¨±ã€ï¼ˆä¾‹å¦‚ï¼šé«˜é›„xxé–€å¸‚ï¼‰ã€‚");
    addressEl.focus();
    return;
  }
}

        const payload = {
          items: cartItems.map((it) => ({
            productId: it.productId,
            specKey: it.specKey,
            specLabel: it.specLabel,
            name: it.name,
            price: it.price,
            qty: it.qty,
          })),
          customer: { name, phone, email, lineId, address, ship, pay, note },
        };

        try {
          const result = await apiPost("/api/orders", payload);

          const order = result.order || result.data || result;
          const orderId = result.orderId || order.id || order.orderId || "ï¼ˆè«‹çœ‹å¾Œå°ï¼‰";
          const createdAt = order.createdAt || result.createdAt || "å‰›å‰›";
          const status = order.status || result.status || "new";

          const total =
            typeof result.totalAmount === "number"
              ? result.totalAmount
              : typeof order.totalAmount === "number"
              ? order.totalAmount
              : calcCartTotal();

          alert(
            "è¨‚å–®å·²å»ºç«‹å›‰ï¼\n\n" +
              "è¨‚å–®ç·¨è™Ÿï¼š" + orderId + "\n" +
              "å»ºç«‹æ™‚é–“ï¼š" + createdAt + "\n" +
              "è¨‚å–®ç‹€æ…‹ï¼š" + status + "\n" +
              "ç¸½é‡‘é¡ï¼šNT$ " + total + "\n\n" +
              "ä¹‹å¾Œå¯ä»¥ç”¨ã€Œé›»è©± + è¨‚å–®ç·¨è™Ÿã€åœ¨ä¸‹æ–¹è¨‚å–®æŸ¥è©¢å€æŸ¥çœ‹é€²åº¦ã€‚\n\n" +
              "åŠ å…¥å®˜æ–¹ LINEï¼š@301gfuhï¼Œå°±å¯ä»¥è¿½è¹¤è¨‚å–®ã€è©¢å•å‡ºè²¨é€²åº¦å–”ï¼"
          );

          window.location.reload();
        } catch (err) {
          console.error("POST /api/orders error", err);
          alert(
            "å»ºç«‹è¨‚å–®æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œå¯èƒ½æ˜¯ç¶²è·¯æˆ–ä¼ºæœå™¨æš«æ™‚æœ‰å•é¡Œï¼Œ\n" +
              "è«‹ç¨å¾Œå†è©¦ä¸€æ¬¡ï¼Œæˆ–æ”¹ç”¨è¦çš® / Line è¯çµ¡åº—ä¸»ã€‚\n\n" +
              err.message
          );
        }
      });
    }

    

// âœ… çµå¸³æ¬„ä½é˜²å‘†ï¼šä¾é…é€æ–¹å¼æç¤ºåœ°å€/é–€å¸‚
function updateCheckoutAddressHint() {
  const shipEl = document.getElementById("checkoutShip");
  const addrLabel = document.querySelector('label[for="checkoutAddress"]');
  const hintEl = document.getElementById("checkoutAddressHint");
  const addrEl = document.getElementById("checkoutAddress");
  if (!shipEl || !addrLabel || !hintEl || !addrEl) return;

  const ship = shipEl.value;
  if (ship === "home") {
    addrLabel.textContent = "æ”¶ä»¶åœ°å€ï¼ˆå®…é…å¿…å¡«ï¼‰";
    addrEl.placeholder = "ä¾‹ï¼šé«˜é›„å¸‚â—‹â—‹å€â—‹â—‹è·¯â—‹æ®µâ—‹è™Ÿâ—‹æ¨“";
    hintEl.textContent = "å®…é…åˆ°åºœï¼šè«‹å¡«å®Œæ•´åœ°å€ï¼ˆå¿…å¡«ï¼‰ã€‚";
  } else if (ship === "711") {
    addrLabel.textContent = "7-11 é–€å¸‚åç¨±ï¼ˆå¿…å¡«ï¼‰";
    addrEl.placeholder = "ä¾‹ï¼šé«˜é›„â—‹â—‹é–€å¸‚ï¼ˆå¯åŠ å€åŸŸæ›´å¥½ï¼‰";
    hintEl.textContent = "è¶…å•†å–è²¨ï¼šè«‹å¡«é–€å¸‚åç¨±ï¼ˆå¿…å¡«ï¼‰ã€‚";
  } else if (ship === "family") {
    addrLabel.textContent = "å…¨å®¶ é–€å¸‚åç¨±ï¼ˆå¿…å¡«ï¼‰";
    addrEl.placeholder = "ä¾‹ï¼šé«˜é›„â—‹â—‹åº—ï¼â—‹â—‹é–€å¸‚";
    hintEl.textContent = "è¶…å•†å–è²¨ï¼šè«‹å¡«é–€å¸‚åç¨±ï¼ˆå¿…å¡«ï¼‰ã€‚";
  } else {
    addrLabel.textContent = "æ”¶ä»¶åœ°å€ / è¶…å•†é–€å¸‚ï¼ˆå¿…å¡«ï¼‰";
    hintEl.textContent = "è«‹å¡«å¯«ï¼šè¶…å•†ï¼ˆ7-11/å…¨å®¶ï¼‰è«‹å¡«ã€Œé–€å¸‚åç¨±ã€ï¼›å®…é…è«‹å¡«å®Œæ•´åœ°å€ã€‚";
  }
}

document.addEventListener("DOMContentLoaded", () => {
  const shipEl = document.getElementById("checkoutShip");
  if (shipEl) shipEl.addEventListener("change", updateCheckoutAddressHint);
  updateCheckoutAddressHint();
});



    /* =========================================================
      I-2) çµå¸³ Email å°¾ç¢¼é¸å–®ï¼ˆgmail/yahoo/outlook...ï¼‰ï¼‹ è‡ªè¨‚ç¶²åŸŸ
    ========================================================= */
    (function initCheckoutEmailSelector(){
      const localEl = document.getElementById("checkoutEmailLocal");
      const domainEl = document.getElementById("checkoutEmailDomain");
      const customEl = document.getElementById("checkoutEmailCustom");
      const hintEl = document.getElementById("emailHint");
      const hiddenEl = document.getElementById("checkoutEmail");

      if (!localEl || !domainEl || !customEl) return;

      function updateVisibility(){
        const isCustom = domainEl.value === "custom";
        customEl.style.display = isCustom ? "block" : "none";
        if (!isCustom) customEl.value = "";
        updatePreview();
      }

      function updatePreview(){
        const local = (localEl.value || "").trim().replace(/\s+/g, "").replace(/@.*/g, "");
        const domain = ((domainEl.value === "custom") ? (customEl.value || "").trim() : domainEl.value)
          .replace(/^@+/, "")
          .replace(/\s+/g, "");

        const email = (local && domain) ? `${local}@${domain}` : "";
        if (hiddenEl) hiddenEl.value = email;

        if (hintEl) {
          hintEl.textContent = email
            ? `å°‡ä½¿ç”¨ï¼š${email}ï¼ˆç”¨æ–¼å¯„é€è¨‚å–®æ˜ç´°èˆ‡å‡ºè²¨é€šçŸ¥ï¼‰`
            : "æœƒå¯„é€è¨‚å–®æ˜ç´°èˆ‡å‡ºè²¨é€šçŸ¥ã€‚";
        }
      }

      // é˜²æ­¢åœ¨ local part è¼¸å…¥ @domain
      localEl.addEventListener("input", () => {
        const v = (localEl.value || "");
        if (v.includes("@")) localEl.value = v.split("@")[0];
        updatePreview();
      });

      domainEl.addEventListener("change", updateVisibility);
      customEl.addEventListener("input", updatePreview);

      updateVisibility();
    })();



    /* =========================================================
      I-3) çµå¸³/è¨‚å–®æŸ¥è©¢ï¼šæ›´å®Œæ•´é˜²å‘†ï¼ˆå³æ™‚æç¤ºã€ä¸åª alertï¼‰
    ========================================================= */
    function ensureMsgEl(inputEl, id, className){
      if (!inputEl) return null;
      let el = document.getElementById(id);
      if (!el) {
        el = document.createElement("div");
        el.id = id;
        el.className = className;
        inputEl.insertAdjacentElement("afterend", el);
      }
      return el;
    }

    function showError(msgEl, text){
      if (!msgEl) return;
      msgEl.textContent = text || "";
      msgEl.style.display = text ? "block" : "none";
    }

    function showOk(msgEl, text){
      if (!msgEl) return;
      msgEl.textContent = text || "";
      msgEl.style.display = text ? "block" : "none";
    }

    function normalizeTwMobile(raw){
      const d = String(raw || "").replace(/\D/g, "");
      // åªä¿ç•™ 10 ç¢¼
      return d.slice(0, 10);
    }

    function isValidTwMobile(raw){
      const d = String(raw || "").replace(/\D/g, "");
      return /^09\d{8}$/.test(d);
    }

    function isValidEmailLoose(email){
      return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/i.test(String(email || "").trim());
    }

    // ---- Checkout live validation
    (function initCheckoutLiveValidation(){
      const nameEl = document.getElementById("checkoutName");
      const phoneEl = document.getElementById("checkoutPhone");
      const shipEl = document.getElementById("checkoutShip");
      const addrEl = document.getElementById("checkoutAddress");

      const emailLocalEl = document.getElementById("checkoutEmailLocal");
      const emailDomainEl = document.getElementById("checkoutEmailDomain");
      const emailCustomEl = document.getElementById("checkoutEmailCustom");
      const hiddenEmailEl = document.getElementById("checkoutEmail");

      const errName = ensureMsgEl(nameEl, "errCheckoutName", "field-error");
      const errPhone = ensureMsgEl(phoneEl, "errCheckoutPhone", "field-error");
      const errEmail = ensureMsgEl(emailLocalEl || hiddenEmailEl, "errCheckoutEmail", "field-error");
      const errAddr = ensureMsgEl(addrEl, "errCheckoutAddress", "field-error");

      if (nameEl) {
        nameEl.addEventListener("input", () => {
          const v = (nameEl.value || "").trim();
          showError(errName, v.length >= 2 ? "" : "å§“åè«‹è‡³å°‘ 2 å€‹å­—");
        });
      }

      if (phoneEl) {
        phoneEl.addEventListener("input", () => {
          const normalized = normalizeTwMobile(phoneEl.value);
          phoneEl.value = normalized;
          showError(errPhone, isValidTwMobile(normalized) ? "" : "è«‹è¼¸å…¥ 09 é–‹é ­çš„ 10 ç¢¼å°ç£æ‰‹æ©Ÿè™Ÿç¢¼");
        });
        phoneEl.addEventListener("blur", () => {
          const normalized = normalizeTwMobile(phoneEl.value);
          showError(errPhone, normalized && !isValidTwMobile(normalized) ? "æ‰‹æ©Ÿæ ¼å¼ä¸æ­£ç¢ºï¼ˆä¾‹ï¼š0912345678ï¼‰" : "");
        });
      }

      function validateAddressByShip(){
        if (!addrEl || !shipEl) return true;
        const ship = shipEl.value;
        const v = (addrEl.value || "").trim();

        if (ship === "home") {
          const ok = v.length >= 6;
          showError(errAddr, ok ? "" : "å®…é…è«‹å¡«å®Œæ•´åœ°å€ï¼ˆè‡³å°‘ 6 å€‹å­—ï¼‰");
          return ok;
        }

        // è¶…å•†ï¼šå¿…å¡«é–€å¸‚
        const ok = v.length >= 3;
        showError(errAddr, ok ? "" : "è¶…å•†å–è²¨è«‹å¡«ã€Œé–€å¸‚åç¨±ã€ï¼ˆå¿…å¡«ï¼‰");
        return ok;
      }

      if (shipEl) shipEl.addEventListener("change", validateAddressByShip);
      if (addrEl) addrEl.addEventListener("input", validateAddressByShip);

      function validateEmailNow(){
        const email = (hiddenEmailEl?.value || "").trim();
        showError(errEmail, email && isValidEmailLoose(email) ? "" : "Email æ ¼å¼ä¸æ­£ç¢ºï¼ˆä¾‹ï¼šyou@gmail.comï¼‰");
        return !email || isValidEmailLoose(email);
      }
      if (emailLocalEl) emailLocalEl.addEventListener("input", validateEmailNow);
      if (emailDomainEl) emailDomainEl.addEventListener("change", validateEmailNow);
      if (emailCustomEl) emailCustomEl.addEventListener("input", validateEmailNow);

      // åˆå§‹è·‘ä¸€æ¬¡ï¼Œé¿å…ç©ºæç¤ºé–ƒçˆ
      validateAddressByShip();
    })();

    // ---- Order query (å‰å°è¨‚å–®æŸ¥è©¢) + live validation
    (function initOrderQueryForm(){
      const form = document.getElementById("orderQueryForm");
      const phoneEl = document.getElementById("queryPhone");
      const idEl = document.getElementById("queryOrderId");
      const resultEl = document.getElementById("orderResult");

      const errPhone = ensureMsgEl(phoneEl, "errQueryPhone", "field-error");
      const errId = ensureMsgEl(idEl, "errQueryOrderId", "field-error");

      if (phoneEl) {
        phoneEl.addEventListener("input", () => {
          const normalized = normalizeTwMobile(phoneEl.value);
          phoneEl.value = normalized;
          showError(errPhone, isValidTwMobile(normalized) ? "" : "è«‹è¼¸å…¥ 09 é–‹é ­çš„ 10 ç¢¼æ‰‹æ©Ÿè™Ÿç¢¼");
        });
      }

      if (idEl) {
        idEl.addEventListener("input", () => {
          const v = (idEl.value || "").trim();
          showError(errId, v ? "" : "è«‹è¼¸å…¥è¨‚å–®ç·¨è™Ÿ");
        });
      }

      function renderOrderResult(order){
        if (!resultEl) return;
        if (!order) { resultEl.innerHTML = ""; return; }

        const items = Array.isArray(order.items) ? order.items : (Array.isArray(order.itemsJson) ? order.itemsJson : []);
        const statusText = order.statusText || order.status || "æœªå®Œæˆ / æ–°è¨‚å–®";
        const createdAt = order.createdAt || "";
        const customer = order.customer || {};
        const total = (typeof order.totalAmount === "number") ? order.totalAmount : null;

        const itemsHtml = (Array.isArray(order.items) ? order.items : [])
          .map(it => {
            const name = it.name || "";
            const spec = it.specLabel ? `ï¼ˆ${it.specLabel}ï¼‰` : "";
            const qty = it.qty || 0;
            return `<li>${name}${spec} Ã— ${qty}</li>`;
          }).join("");

        resultEl.innerHTML = `
          <div style="margin-top:12px;padding:12px 14px;border-radius:14px;background:#fffdf5;border:1px dashed #f0d9a4;color:#4f3b2a;">
            <div style="display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;">
              <div><strong>è¨‚å–®ç·¨è™Ÿï¼š</strong>${order.id || ""}</div>
              <div><strong>ç‹€æ…‹ï¼š</strong>${statusText}</div>
            </div>
            ${createdAt ? `<div style="margin-top:6px;font-size:13px;color:#9a7641;">å»ºç«‹æ™‚é–“ï¼š${createdAt}</div>` : ""}
            <div style="margin-top:8px;font-size:13px;">
              <div><strong>æ”¶ä»¶äººï¼š</strong>${customer.name || "-"}</div>
              <div><strong>é…é€ï¼š</strong>${customer.ship || "-"}</div>
              <div><strong>åœ°å€ / é–€å¸‚ï¼š</strong>${customer.address || "-"}</div>
            </div>
            ${itemsHtml ? `<div style="margin-top:10px;"><strong>å•†å“ï¼š</strong><ul style="padding-left:18px;margin-top:6px;">${itemsHtml}</ul></div>` : ""}
            ${total !== null ? `<div style="margin-top:10px;"><strong>ç¸½é‡‘é¡ï¼š</strong>NT$ ${total}</div>` : ""}
          </div>
        `;
      }

      if (!form) return;
      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const phone = normalizeTwMobile(phoneEl?.value || "");
        const orderId = (idEl?.value || "").trim();

        if (!isValidTwMobile(phone)) {
          showError(errPhone, "è«‹è¼¸å…¥ 09 é–‹é ­çš„ 10 ç¢¼æ‰‹æ©Ÿè™Ÿç¢¼");
          return;
        } else showError(errPhone, "");

        if (!orderId) {
          showError(errId, "è«‹è¼¸å…¥è¨‚å–®ç·¨è™Ÿ");
          return;
        } else showError(errId, "");

        if (resultEl) resultEl.innerHTML = "æŸ¥è©¢ä¸­â€¦";

        try {
          const data = await apiGet(`/api/orders/query?phone=${encodeURIComponent(phone)}&id=${encodeURIComponent(orderId)}`);
          const order = data?.order || data?.data || data;
          renderOrderResult(order);
        } catch (err) {
          console.error("Order query error", err);
          if (resultEl) {
            resultEl.innerHTML = `
              <div style="margin-top:12px;padding:12px 14px;border-radius:14px;background:#fff0f0;border:1px solid #f3b2b2;color:#8b2b2b;">
                æŸ¥è©¢å¤±æ•—ï¼š${(err && err.message) ? err.message : "è«‹ç¨å¾Œå†è©¦"}
              </div>
            `;
          }
        }
      });
    })();


/* =========================================================
      J) Hero ç”¢å“åœ–è¼ªæ’­
    ========================================================= */
    let heroSlideIndex = 0;
    let heroSlideTimer = null;

    function pickHeroProducts(list){
      const arr = Array.isArray(list) ? list.slice() : [];
      const preferred = arr.filter(p => {
        const t = String(p.tag || "");
        return t.includes("ä¸»æ‰“") || t.includes("ç†±è³£") || t.includes("æ–°å“");
      });
      return (preferred.length ? preferred : arr).slice(0, 6);
    }

    function buildHeroSlides(){
      const slidesEl = document.getElementById("heroBannerSlides");
      const dotsEl = document.getElementById("heroBannerDots");
      if (!slidesEl || !dotsEl) return;

      slidesEl.innerHTML = "";
      dotsEl.innerHTML = "";

      const picked = pickHeroProducts(products);

      if (!picked.length) {
        slidesEl.innerHTML = `
          <div class="hero-banner-slide active">
            <div class="hero-banner-top">
              <div>
                <div class="hero-banner-tag">ä¸»æ‰“å•†å“</div>
                <div class="hero-banner-title">ç›®å‰å°šæœªè¼‰å…¥å•†å“</div>
                <div class="hero-banner-sub">è«‹ç¢ºèªå¾Œç«¯ /api/products æ˜¯å¦æ­£å¸¸å›å‚³ã€‚</div>
              </div>
            </div>
          </div>
        `;
        return;
      }

      picked.forEach((p, idx) => {
        const specs = p.specs || [];
        const firstSpec = specs[0];

        const imgRaw =
          p.imageUrl ||
          (firstSpec && firstSpec.mainImg) ||
          (firstSpec && firstSpec.thumbs && firstSpec.thumbs[0]) ||
          "";

        const title = p.name || "å•†å“";
        const sub = p.subtitle || p.shortDesc || "é»æ“ŠæŸ¥çœ‹å•†å“è©³æƒ…";
        const tag = p.tag || "ä¸»æ‰“å•†å“";

        const slide = document.createElement("div");
        slide.className = "hero-banner-slide" + (idx === 0 ? " active" : "");
        slide.innerHTML = `
          <div class="hero-banner-top">
            <div>
              <div class="hero-banner-tag">${tag}</div>
              <div class="hero-banner-title">${title}</div>
              <div class="hero-banner-sub">${sub}</div>
            </div>
          </div>

          <div class="hero-banner-media" role="button" aria-label="é–‹å•Ÿå•†å“è©³æƒ…">
            ${imgRaw ? `<img src="${resolveImgUrl(imgRaw)}" alt="${title}">` : ""}
          </div>

          <div class="hero-banner-cta">
            <button type="button" class="cta-primary">æŸ¥çœ‹å•†å“</button>
            <button type="button" class="cta-secondary">åŠ å…¥è³¼ç‰©è»Š</button>
          </div>
        `;

        const media = slide.querySelector(".hero-banner-media");
        const ctaView = slide.querySelector(".cta-primary");
        if (media) media.addEventListener("click", () => openProduct(p.id));
        if (ctaView) ctaView.addEventListener("click", () => openProduct(p.id));

        const ctaAdd = slide.querySelector(".cta-secondary");
        if (ctaAdd) {
          ctaAdd.addEventListener("click", () => {
            const specKey = (p.specs && p.specs[0] && p.specs[0].key) ? p.specs[0].key : "";
            addToCart(p.id, specKey, 1);
            scrollToSection("cart");
          });
        }

        slidesEl.appendChild(slide);

        const dot = document.createElement("button");
        dot.type = "button";
        dot.className = "hero-dot" + (idx === 0 ? " active" : "");
        dot.setAttribute("aria-label", `ç¬¬ ${idx + 1} å¼µ Banner`);
        dot.addEventListener("click", () => {
          showHeroSlide(idx);
          restartHeroTimer();
        });
        dotsEl.appendChild(dot);
      });
    }

    function showHeroSlide(i){
      const slides = document.querySelectorAll("#heroBannerSlides .hero-banner-slide");
      const dots = document.querySelectorAll("#heroBannerDots .hero-dot");
      if (!slides.length || !dots.length) return;

      const total = slides.length;
      heroSlideIndex = (i + total) % total;

      slides.forEach((s, idx) => s.classList.toggle("active", idx === heroSlideIndex));
      dots.forEach((d, idx) => d.classList.toggle("active", idx === heroSlideIndex));
    }

    function nextHeroSlide(){ showHeroSlide(heroSlideIndex + 1); }

    function restartHeroTimer(){
      if (heroSlideTimer) clearInterval(heroSlideTimer);
      heroSlideTimer = setInterval(nextHeroSlide, 6000);
    }

    function initHeroBanner(){
      buildHeroSlides();
      showHeroSlide(0);
      restartHeroTimer();

      document.addEventListener("visibilitychange", () => {
        if (document.hidden) {
          if (heroSlideTimer) clearInterval(heroSlideTimer);
        } else {
          restartHeroTimer();
        }
      });
    }

    /* =========================================================
      Lightbox
    ========================================================= */
    const lb = document.getElementById("imgLightbox");
    const lbImg = document.getElementById("lbImg");
    const lbClose = document.getElementById("lbClose");
    const lbPrev = document.getElementById("lbPrev");
    const lbNext = document.getElementById("lbNext");
    const lbStage = document.getElementById("lbStage");

    let lbList = [];
    let lbIndex = 0;

    function openLightbox(list, startIndex = 0){
      lbList = Array.isArray(list) ? list.filter(Boolean) : [];
      lbIndex = Math.max(0, Math.min(startIndex, lbList.length - 1));
      if (!lbList.length) return;

      lbImg.src = resolveImgUrl(lbList[lbIndex]);
      lb.classList.add("open");
      lb.setAttribute("aria-hidden", "false");
      document.body.style.overflow = "hidden";
    }

    function closeLightbox(){
      lb.classList.remove("open");
      lb.setAttribute("aria-hidden", "true");
      document.body.style.overflow = "";
      lbImg.src = "";
    }

    function lightboxGo(delta){
      if (!lbList.length) return;
      lbIndex = (lbIndex + delta + lbList.length) % lbList.length;
      lbImg.src = resolveImgUrl(lbList[lbIndex]);
    }

    lbClose.addEventListener("click", closeLightbox);
    lb.addEventListener("click", (e) => { if (e.target === lb) closeLightbox(); });
    lbPrev.addEventListener("click", (e) => { e.stopPropagation(); lightboxGo(-1); });
    lbNext.addEventListener("click", (e) => { e.stopPropagation(); lightboxGo(1); });

    document.addEventListener("keydown", (e) => {
      if (!lb.classList.contains("open")) return;
      if (e.key === "Escape") closeLightbox();
      if (e.key === "ArrowLeft") lightboxGo(-1);
      if (e.key === "ArrowRight") lightboxGo(1);
    });

    let touchStartX = 0;
    lbStage.addEventListener("touchstart", (e) => { touchStartX = e.touches[0].clientX; }, { passive: true });
    lbStage.addEventListener("touchend", (e) => {
      const endX = (e.changedTouches && e.changedTouches[0]) ? e.changedTouches[0].clientX : touchStartX;
      const dx = endX - touchStartX;
      if (Math.abs(dx) > 40) dx > 0 ? lightboxGo(-1) : lightboxGo(1);
    }, { passive: true });

    if (detailMainImg) {
      detailMainImg.style.cursor = "zoom-in";
      detailMainImg.addEventListener("click", () => {
        const p = products.find(x => x.id === currentDetailProductId);
        if (!p) return;

        const spec = (p.specs || []).find(s => s.key === currentDetailSpecKey) || (p.specs || [])[0];
        const thumbs = (spec && spec.thumbs && spec.thumbs.length) ? spec.thumbs : [];

        const currentSrcRaw = (spec && spec.mainImg) ? spec.mainImg : (p.imageUrl || "");
        const list = thumbs.length ? thumbs : [currentSrcRaw];

        const currentResolved = resolveImgUrl(currentSrcRaw);
        let start = 0;
        for (let i = 0; i < list.length; i++){
          if (resolveImgUrl(list[i]) === currentResolved) { start = i; break; }
        }
        openLightbox(list, start);
      });
    }

    lbStage.addEventListener("wheel", (e) => {
      if (!lb.classList.contains("open")) return;
      e.preventDefault();
      if (e.deltaY > 0) lightboxGo(1);
      else lightboxGo(-1);
    }, { passive: false });

    /* =========================================================
      K) åˆå§‹åŒ–
    ========================================================= */
    async function initPage() {
      updateCartBtnText();
      await loadProducts();

      currentCategory = "all";
      currentKeyword = "";

      renderProductGrid();
      renderCart();
      updateCartSummary();

      const checkoutShipEl = document.getElementById("checkoutShip");
      if (checkoutShipEl) checkoutShipEl.addEventListener("change", () => updateCartSummary());

      initHeroBanner();
    }

    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initPage);
    } else {
      initPage();
    }
  </script>
</body>
</html>
